{"ast":null,"code":"import React,{useState,useEffect,useMemo}from'react';import{useAuth}from'../context/AuthContext';import{useNavigate}from'react-router-dom';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faPlus,faCheck,faTimes,faMoneyBillWave,faHistory,faCalculator}from'@fortawesome/free-solid-svg-icons';// --- HOOK POUR LA RESPONSIVITÉ ---\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const useWindowSize=()=>{const[size,setSize]=useState([window.innerWidth]);useEffect(()=>{const handleResize=()=>setSize([window.innerWidth]);window.addEventListener('resize',handleResize);return()=>window.removeEventListener('resize',handleResize);},[]);return{width:size[0]};};// --- INTERFACES ADAPTÉES À L'API DJANGO ---\n// --- CONSTANTES ---\nconst MOBILE_BREAKPOINT=768;const API_BASE_URL='http://172.30.240.1:8000/api';// --- SERVICE DE LOGIQUE MÉTIER SELON LA CHARTE FRIENDLY BANKS ---\nconst LoanService={getMaxLoanAmount:berryPoints=>{if(berryPoints>=10&&berryPoints<=100)return 60000;if(berryPoints>100&&berryPoints<=199)return 120000;if(berryPoints>=200&&berryPoints<=499)return 300000;if(berryPoints>=500)return 500000;return 0;},getInterestRate:amount=>{if(amount>0&&amount<40000)return 10;if(amount>=40000&&amount<100000)return 8;if(amount>=100000)return 6;return 0;},calculateTotalToRepay:(amount,interestRate)=>{return amount*(1+interestRate/100);},getStatusDisplayName:status=>{const statusMap={'pending':'En attente','approved':'Approuvé','rejected':'Rejeté','repaid':'Remboursé'};return statusMap[status]||status;},getPaymentTypeDisplayName:type=>{const typeMap={'partial':'Remboursement partiel','interest_only':'Intérêts uniquement','full':'Remboursement complet'};return typeMap[type]||type;}};// --- COMPOSANT PRINCIPAL ---\nconst Loans=()=>{const{user,hasPermission}=useAuth();const navigate=useNavigate();// --- ÉTATS PRÊTS ---\nconst[loans,setLoans]=useState([]);const[members,setMembers]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[isLoanModalOpen,setIsLoanModalOpen]=useState(false);const[isSubmitting,setIsSubmitting]=useState(false);const[formError,setFormError]=useState('');// --- ÉTATS REMBOURSEMENTS ---\nconst[repayments,setRepayments]=useState([]);const[isRepaymentModalOpen,setIsRepaymentModalOpen]=useState(false);const[selectedLoanForRepayment,setSelectedLoanForRepayment]=useState(null);const[activeTab,setActiveTab]=useState('loans');const initialLoanFormState={member:0,amount:5000,justification:'',guarantors:[]};const initialRepaymentFormState={loan_request:0,amount:0,payment_type:'partial',notes:''};const[newLoanRequest,setNewLoanRequest]=useState(initialLoanFormState);const[newRepayment,setNewRepayment]=useState(initialRepaymentFormState);const[guarantor1Id,setGuarantor1Id]=useState(0);const[guarantor2Id,setGuarantor2Id]=useState(0);// --- CALCULS MEMOIZÉS ---\nconst selectedMember=useMemo(()=>{return members.find(m=>m.id===newLoanRequest.member);},[newLoanRequest.member,members]);const loanDetails=useMemo(()=>{if(!selectedMember)return null;const maxAmount=LoanService.getMaxLoanAmount(selectedMember.berry_score);const interestRate=LoanService.getInterestRate(newLoanRequest.amount);const totalToRepay=LoanService.calculateTotalToRepay(newLoanRequest.amount,interestRate);let error='';if(newLoanRequest.amount>maxAmount){error=`Le montant dépasse votre plafond de prêt de ${maxAmount.toLocaleString()} XAF.`;}return{maxAmount,interestRate,totalToRepay,error};},[newLoanRequest.amount,selectedMember]);const repaymentCalculations=useMemo(()=>{if(!selectedLoanForRepayment)return null;const loan=selectedLoanForRepayment;const amount=newRepayment.amount;if(amount<=0)return null;let capitalAmount=0;let interestAmount=0;let error='';if(amount>loan.remaining_balance){error=`Le montant dépasse le solde restant (${loan.remaining_balance.toLocaleString()} XAF)`;}else if(newRepayment.payment_type==='interest_only'){if(amount>loan.remaining_interest){error=`Le montant dépasse les intérêts restants (${loan.remaining_interest.toLocaleString()} XAF)`;}else{interestAmount=amount;capitalAmount=0;}}else{// Remboursement partiel ou complet\nif(amount<=loan.remaining_interest){interestAmount=amount;capitalAmount=0;}else{interestAmount=loan.remaining_interest;capitalAmount=amount-loan.remaining_interest;// Vérifier le minimum de 10% du capital pour les remboursements de capital\nif(capitalAmount>0&&capitalAmount<loan.minimum_monthly_payment&&loan.remaining_capital>loan.minimum_monthly_payment){error=`Le remboursement de capital doit être d'au moins ${loan.minimum_monthly_payment.toLocaleString()} XAF (10% du capital restant)`;}}}return{capitalAmount,interestAmount,error};},[newRepayment.amount,newRepayment.payment_type,selectedLoanForRepayment]);const loanStats=useMemo(()=>({pendingCount:loans.filter(l=>l.status==='pending').length,activeLoanAmount:loans.filter(l=>l.status==='approved').reduce((sum,l)=>sum+l.remaining_balance,0),repaidAmount:loans.reduce((sum,l)=>sum+l.total_repaid,0)}),[loans]);// --- FONCTIONS API ---\nconst fetchLoans=async()=>{try{setLoading(true);setError(null);const response=await fetch(`${API_BASE_URL}/loan-requests/`,{headers:{'Authorization':`Bearer ${user===null||user===void 0?void 0:user.token}`,'Content-Type':'application/json'}});if(!response.ok){throw new Error(`Erreur HTTP: ${response.status}`);}const data=await response.json();setLoans(data);}catch(err){setError(err instanceof Error?err.message:'Erreur lors du chargement des prêts');console.error('Erreur lors du chargement des prêts:',err);}finally{setLoading(false);}};const fetchRepayments=async()=>{try{const response=await fetch(`${API_BASE_URL}/loan-repayments/`,{headers:{'Authorization':`Bearer ${user===null||user===void 0?void 0:user.token}`,'Content-Type':'application/json'}});if(!response.ok){throw new Error(`Erreur HTTP: ${response.status}`);}const data=await response.json();setRepayments(data);}catch(err){console.error('Erreur lors du chargement des remboursements:',err);}};const fetchMembers=async()=>{try{const response=await fetch(`${API_BASE_URL}/members/`,{headers:{'Authorization':`Bearer ${user===null||user===void 0?void 0:user.token}`,'Content-Type':'application/json'}});if(!response.ok){throw new Error(`Erreur HTTP: ${response.status}`);}const data=await response.json();setMembers(data);}catch(err){console.error('Erreur lors du chargement des membres:',err);}};// Charger les données au montage du composant\nuseEffect(()=>{if(user!==null&&user!==void 0&&user.token){fetchLoans();fetchRepayments();fetchMembers();}},[user===null||user===void 0?void 0:user.token]);const{width}=useWindowSize();const isMobile=width<MOBILE_BREAKPOINT;// --- VÉRIFICATION DES PERMISSIONS ---\nif(!hasPermission('view_loans')){return/*#__PURE__*/_jsx(\"div\",{style:styles.page,children:/*#__PURE__*/_jsxs(\"div\",{style:styles.errorContainer,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Acc\\xE8s refus\\xE9\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Vous n'avez pas la permission de consulter les pr\\xEAts.\"})]})});}// --- GESTIONNAIRES D'ÉVÉNEMENTS PRÊTS ---\nconst handleOpenLoanModal=()=>{if(!hasPermission('add_loan_requests')){alert(\"Vous n'avez pas la permission de faire une demande de prêt.\");return;}const currentMember=members.find(m=>m.user.id===parseInt((user===null||user===void 0?void 0:user.id)||'0'));setNewLoanRequest({...initialLoanFormState,member:(currentMember===null||currentMember===void 0?void 0:currentMember.id)||0});setGuarantor1Id(0);setGuarantor2Id(0);setFormError('');setIsLoanModalOpen(true);};const handleStatusUpdate=async(id,status)=>{if(!hasPermission('approve_loans')){alert(\"Vous n'avez pas la permission d'approuver des prêts.\");return;}try{const response=await fetch(`${API_BASE_URL}/loan-requests/${id}/`,{method:'PATCH',headers:{'Authorization':`Bearer ${user===null||user===void 0?void 0:user.token}`,'Content-Type':'application/json'},body:JSON.stringify({status})});if(!response.ok){throw new Error('Erreur lors de la mise à jour du statut');}await fetchLoans();alert(`Prêt ${status==='approved'?'approuvé':'rejeté'} avec succès`);}catch(err){console.error('Erreur lors de la mise à jour:',err);alert('Erreur lors de la mise à jour du statut');}};const handleSaveLoanRequest=async()=>{if(!selectedMember||!loanDetails||!newLoanRequest.justification||!guarantor1Id||!guarantor2Id){setFormError(\"Veuillez remplir tous les champs.\");return;}if(loanDetails.error){setFormError(loanDetails.error);return;}if(guarantor1Id===guarantor2Id||guarantor1Id===selectedMember.id||guarantor2Id===selectedMember.id){setFormError(\"Veuillez choisir deux avaliseurs distincts et différents de vous-même.\");return;}setIsSubmitting(true);setFormError('');try{const loanData={member:newLoanRequest.member,amount:newLoanRequest.amount,justification:newLoanRequest.justification,guarantors:[guarantor1Id,guarantor2Id],interest_rate:loanDetails.interestRate};const response=await fetch(`${API_BASE_URL}/loan-requests/`,{method:'POST',headers:{'Authorization':`Bearer ${user===null||user===void 0?void 0:user.token}`,'Content-Type':'application/json'},body:JSON.stringify(loanData)});if(!response.ok){const errorData=await response.json();throw new Error(errorData.error||'Erreur lors de la création de la demande');}await fetchLoans();setIsLoanModalOpen(false);alert('Demande de prêt soumise avec succès !');}catch(err){setFormError(err instanceof Error?err.message:'Erreur lors de la création');console.error('Erreur lors de la création:',err);}finally{setIsSubmitting(false);}};// --- GESTIONNAIRES D'ÉVÉNEMENTS REMBOURSEMENTS ---\nconst handleOpenRepaymentModal=loan=>{if(!hasPermission('add_repayments')&&!hasPermission('manage_loans')){alert(\"Vous n'avez pas la permission d'effectuer des remboursements.\");return;}if(loan.status!=='approved'){alert(\"Seuls les prêts approuvés peuvent faire l'objet de remboursements.\");return;}setSelectedLoanForRepayment(loan);setNewRepayment({...initialRepaymentFormState,loan_request:loan.id,amount:loan.minimum_monthly_payment});setFormError('');setIsRepaymentModalOpen(true);};const handleSaveRepayment=async()=>{if(!selectedLoanForRepayment||!repaymentCalculations||repaymentCalculations.error){setFormError((repaymentCalculations===null||repaymentCalculations===void 0?void 0:repaymentCalculations.error)||\"Veuillez vérifier les données saisies.\");return;}if(newRepayment.amount<=0){setFormError(\"Le montant doit être positif.\");return;}setIsSubmitting(true);setFormError('');try{const repaymentData={loan_request:newRepayment.loan_request,amount:newRepayment.amount,payment_type:newRepayment.payment_type,notes:newRepayment.notes,capital_amount:repaymentCalculations.capitalAmount,interest_amount:repaymentCalculations.interestAmount};const response=await fetch(`${API_BASE_URL}/loan-repayments/`,{method:'POST',headers:{'Authorization':`Bearer ${user===null||user===void 0?void 0:user.token}`,'Content-Type':'application/json'},body:JSON.stringify(repaymentData)});if(!response.ok){const errorData=await response.json();throw new Error(errorData.error||'Erreur lors de la création du remboursement');}await fetchLoans();await fetchRepayments();setIsRepaymentModalOpen(false);alert('Remboursement effectué avec succès !');}catch(err){setFormError(err instanceof Error?err.message:'Erreur lors du remboursement');console.error('Erreur lors du remboursement:',err);}finally{setIsSubmitting(false);}};const getMemberName=memberId=>{const member=members.find(m=>m.id===memberId);return member?`${member.user.first_name} ${member.user.last_name}`:'Membre inconnu';};const getGuarantorNames=guarantorIds=>{return guarantorIds.map(id=>getMemberName(id)).join(', ');};// --- PERMISSIONS D'AFFICHAGE ---\nconst canViewStats=hasPermission('view_reports')||hasPermission('approve_loans');const canAddLoans=hasPermission('add_loan_requests');const canApproveLoans=hasPermission('approve_loans');const canAddRepayments=hasPermission('add_repayments')||hasPermission('manage_loans');// --- AFFICHAGE DE L'ERREUR ---\nif(error&&!loading){return/*#__PURE__*/_jsx(\"div\",{style:styles.page,children:/*#__PURE__*/_jsxs(\"div\",{style:styles.errorContainer,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Erreur de chargement\"}),/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchLoans,style:styles.button,children:\"R\\xE9essayer\"})]})});}// --- RENDU PRINCIPAL ---\nreturn/*#__PURE__*/_jsxs(\"div\",{style:styles.page,children:[/*#__PURE__*/_jsxs(\"header\",{style:styles.header,children:[/*#__PURE__*/_jsxs(\"h2\",{style:styles.headerTitle,children:[\"Gestion des Pr\\xEAts & Remboursements\",loading&&/*#__PURE__*/_jsx(\"span\",{style:styles.loadingText,children:\" (Chargement...)\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/'),style:{...styles.button,backgroundColor:'#6b7280'},children:\"\\u2190 Retour\"})]}),canViewStats&&/*#__PURE__*/_jsxs(\"section\",{style:styles.statSection,children:[/*#__PURE__*/_jsx(StatCard,{title:\"Solde des Pr\\xEAts Actifs\",value:`${loanStats.activeLoanAmount.toLocaleString()} XAF`}),/*#__PURE__*/_jsx(StatCard,{title:\"Demandes en Attente\",value:loanStats.pendingCount}),/*#__PURE__*/_jsx(StatCard,{title:\"Total Rembours\\xE9\",value:`${loanStats.repaidAmount.toLocaleString()} XAF`})]}),/*#__PURE__*/_jsxs(\"section\",{style:styles.tabSection,children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('loans'),style:{...styles.tabButton,...(activeTab==='loans'?styles.activeTab:styles.inactiveTab)},children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faMoneyBillWave,style:{marginRight:'8px'}}),\"Pr\\xEAts\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('repayments'),style:{...styles.tabButton,...(activeTab==='repayments'?styles.activeTab:styles.inactiveTab)},children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faHistory,style:{marginRight:'8px'}}),\"Remboursements\"]})]}),activeTab==='loans'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"section\",{style:styles.controlsSection,children:canAddLoans&&/*#__PURE__*/_jsxs(\"button\",{onClick:handleOpenLoanModal,style:styles.button,children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faPlus,style:{marginRight:'8px'}}),\"Faire une Demande de Pr\\xEAt\"]})}),loading?/*#__PURE__*/_jsx(\"div\",{style:styles.loadingContainer,children:/*#__PURE__*/_jsx(\"p\",{children:\"Chargement des pr\\xEAts...\"})}):loans.length===0?/*#__PURE__*/_jsxs(\"div\",{style:styles.emptyState,children:[/*#__PURE__*/_jsx(\"p\",{children:\"Aucune demande de pr\\xEAt trouv\\xE9e.\"}),canAddLoans&&/*#__PURE__*/_jsx(\"p\",{children:\"Commencez par faire votre premi\\xE8re demande !\"})]}):isMobile?/*#__PURE__*/_jsx(MobileLoanList,{loans:loans,members:members,hasPermission:hasPermission,onStatusUpdate:handleStatusUpdate,onRepayment:handleOpenRepaymentModal,getMemberName:getMemberName,getGuarantorNames:getGuarantorNames,canAddRepayments:canAddRepayments}):/*#__PURE__*/_jsx(DesktopLoanTable,{loans:loans,members:members,hasPermission:hasPermission,onStatusUpdate:handleStatusUpdate,onRepayment:handleOpenRepaymentModal,getMemberName:getMemberName,getGuarantorNames:getGuarantorNames,canAddRepayments:canAddRepayments})]}):/*#__PURE__*/_jsx(RepaymentSection,{repayments:repayments,loading:loading,isMobile:isMobile}),!canAddLoans&&!canAddRepayments&&/*#__PURE__*/_jsx(\"div\",{style:styles.permissionInfo,children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Information :\"}),\" Vous pouvez consulter les pr\\xEAts et remboursements mais pas en effectuer. Contactez le Comit\\xE9 de Gestion pour plus d'informations.\"]})}),isLoanModalOpen&&/*#__PURE__*/_jsx(\"div\",{style:styles.modalOverlay,children:/*#__PURE__*/_jsxs(\"div\",{style:styles.modalContent,children:[/*#__PURE__*/_jsx(\"h3\",{style:styles.modalTitle,children:\"Nouvelle Demande de Pr\\xEAt\"}),formError&&/*#__PURE__*/_jsx(\"p\",{style:styles.formError,children:formError}),/*#__PURE__*/_jsxs(\"div\",{style:styles.modalForm,children:[hasPermission('create_loan_for_others')?/*#__PURE__*/_jsxs(ModalSelect,{label:\"Membre demandeur\",value:newLoanRequest.member,onChange:e=>setNewLoanRequest({...newLoanRequest,member:parseInt(e.target.value)}),disabled:isSubmitting,children:[/*#__PURE__*/_jsx(\"option\",{value:0,disabled:true,children:\"S\\xE9lectionner un membre...\"}),members.map(m=>/*#__PURE__*/_jsxs(\"option\",{value:m.id,children:[m.user.first_name,\" \",m.user.last_name,\" (\",m.berry_score,\" pts Berry)\"]},m.id))]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:styles.modalLabel,children:\"Membre demandeur\"}),/*#__PURE__*/_jsx(\"div\",{style:styles.disabledInput,children:selectedMember?`${selectedMember.user.first_name} ${selectedMember.user.last_name}`:'Membre Actuel'})]}),selectedMember&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ModalInput,{label:\"Montant souhait\\xE9 (XAF)\",type:\"number\",step:\"1000\",value:newLoanRequest.amount,onChange:e=>setNewLoanRequest({...newLoanRequest,amount:parseFloat(e.target.value)||0}),disabled:isSubmitting}),loanDetails&&/*#__PURE__*/_jsxs(\"div\",{style:styles.loanDetailsBox,children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Plafond de pr\\xEAt: \",/*#__PURE__*/_jsxs(\"strong\",{children:[loanDetails.maxAmount.toLocaleString(),\" XAF\"]})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Taux d'int\\xE9r\\xEAt: \",/*#__PURE__*/_jsxs(\"strong\",{children:[loanDetails.interestRate,\"%\"]})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Total \\xE0 rembourser: \",/*#__PURE__*/_jsxs(\"strong\",{children:[loanDetails.totalToRepay.toLocaleString(),\" XAF\"]})]}),loanDetails.error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'#ef4444'},children:loanDetails.error})]}),/*#__PURE__*/_jsx(ModalTextarea,{label:\"Motif de la demande (urgence av\\xE9r\\xE9e)\",value:newLoanRequest.justification,onChange:e=>setNewLoanRequest({...newLoanRequest,justification:e.target.value}),placeholder:\"D\\xE9crivez pr\\xE9cis\\xE9ment la nature de votre urgence...\",disabled:isSubmitting}),/*#__PURE__*/_jsxs(ModalSelect,{label:\"Avaliseur / Garant 1\",value:guarantor1Id,onChange:e=>setGuarantor1Id(parseInt(e.target.value)),disabled:isSubmitting,children:[/*#__PURE__*/_jsx(\"option\",{value:0,disabled:true,children:\"S\\xE9lectionner...\"}),members.filter(m=>m.id!==newLoanRequest.member).map(m=>/*#__PURE__*/_jsxs(\"option\",{value:m.id,children:[m.user.first_name,\" \",m.user.last_name]},m.id))]}),/*#__PURE__*/_jsxs(ModalSelect,{label:\"Avaliseur / Garant 2\",value:guarantor2Id,onChange:e=>setGuarantor2Id(parseInt(e.target.value)),disabled:isSubmitting,children:[/*#__PURE__*/_jsx(\"option\",{value:0,disabled:true,children:\"S\\xE9lectionner...\"}),members.filter(m=>m.id!==newLoanRequest.member).map(m=>/*#__PURE__*/_jsxs(\"option\",{value:m.id,children:[m.user.first_name,\" \",m.user.last_name]},m.id))]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.modalActions,children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsLoanModalOpen(false),style:{...styles.button,backgroundColor:'#6b7280'},disabled:isSubmitting,children:\"Annuler\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSaveLoanRequest,style:styles.button,disabled:isSubmitting,children:isSubmitting?'Soumission...':'Soumettre la Demande'})]})]})}),isRepaymentModalOpen&&selectedLoanForRepayment&&/*#__PURE__*/_jsx(\"div\",{style:styles.modalOverlay,children:/*#__PURE__*/_jsxs(\"div\",{style:styles.modalContent,children:[/*#__PURE__*/_jsx(\"h3\",{style:styles.modalTitle,children:\"Effectuer un Remboursement\"}),formError&&/*#__PURE__*/_jsx(\"p\",{style:styles.formError,children:formError}),/*#__PURE__*/_jsxs(\"div\",{style:styles.modalForm,children:[/*#__PURE__*/_jsxs(\"div\",{style:styles.loanInfoBox,children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Informations du Pr\\xEAt #\",selectedLoanForRepayment.id]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Emprunteur :\"}),\" \",selectedLoanForRepayment.member_name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Montant initial :\"}),\" \",selectedLoanForRepayment.amount.toLocaleString(),\" XAF\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Solde restant :\"}),\" \",selectedLoanForRepayment.remaining_balance.toLocaleString(),\" XAF\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Capital restant :\"}),\" \",selectedLoanForRepayment.remaining_capital.toLocaleString(),\" XAF\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Int\\xE9r\\xEAts restants :\"}),\" \",selectedLoanForRepayment.remaining_interest.toLocaleString(),\" XAF\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Paiement minimum :\"}),\" \",selectedLoanForRepayment.minimum_monthly_payment.toLocaleString(),\" XAF\"]})]}),/*#__PURE__*/_jsxs(ModalSelect,{label:\"Type de remboursement\",value:newRepayment.payment_type,onChange:e=>setNewRepayment({...newRepayment,payment_type:e.target.value}),disabled:isSubmitting,children:[/*#__PURE__*/_jsx(\"option\",{value:\"partial\",children:\"Remboursement partiel\"}),/*#__PURE__*/_jsx(\"option\",{value:\"interest_only\",children:\"Int\\xE9r\\xEAts uniquement\"}),/*#__PURE__*/_jsx(\"option\",{value:\"full\",children:\"Remboursement complet\"})]}),/*#__PURE__*/_jsx(ModalInput,{label:\"Montant \\xE0 rembourser (XAF)\",type:\"number\",step:\"100\",value:newRepayment.amount,onChange:e=>setNewRepayment({...newRepayment,amount:parseFloat(e.target.value)||0}),disabled:isSubmitting}),repaymentCalculations&&/*#__PURE__*/_jsxs(\"div\",{style:styles.calculationBox,children:[/*#__PURE__*/_jsxs(\"h4\",{children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCalculator}),\" R\\xE9partition du remboursement :\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Capital :\"}),\" \",repaymentCalculations.capitalAmount.toLocaleString(),\" XAF\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Int\\xE9r\\xEAts :\"}),\" \",repaymentCalculations.interestAmount.toLocaleString(),\" XAF\"]}),repaymentCalculations.error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'#ef4444'},children:repaymentCalculations.error})]}),/*#__PURE__*/_jsx(ModalTextarea,{label:\"Notes (optionnel)\",value:newRepayment.notes,onChange:e=>setNewRepayment({...newRepayment,notes:e.target.value}),placeholder:\"Notes sur ce remboursement...\",disabled:isSubmitting})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.modalActions,children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsRepaymentModalOpen(false),style:{...styles.button,backgroundColor:'#6b7280'},disabled:isSubmitting,children:\"Annuler\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSaveRepayment,style:styles.button,disabled:isSubmitting||(repaymentCalculations!==null&&repaymentCalculations!==void 0&&repaymentCalculations.error?true:false),children:isSubmitting?'Traitement...':'Effectuer le Remboursement'})]})]})})]});};// --- COMPOSANTS SPÉCIALISÉS ---\n// Section Remboursements\nconst RepaymentSection=_ref=>{let{repayments,loading,isMobile}=_ref;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'16px',color:'#1f2937'},children:\"Historique des Remboursements\"}),loading?/*#__PURE__*/_jsx(\"div\",{style:styles.loadingContainer,children:/*#__PURE__*/_jsx(\"p\",{children:\"Chargement des remboursements...\"})}):repayments.length===0?/*#__PURE__*/_jsx(\"div\",{style:styles.emptyState,children:/*#__PURE__*/_jsx(\"p\",{children:\"Aucun remboursement enregistr\\xE9.\"})}):isMobile?/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',gap:'16px'},children:repayments.map(repayment=>/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCard,children:[/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCardHeader,children:[/*#__PURE__*/_jsxs(\"span\",{style:{fontWeight:'bold'},children:[\"Pr\\xEAt #\",repayment.loan_request,\" - \",repayment.loan_member_name]}),/*#__PURE__*/_jsx(\"span\",{style:{...styles.chip,backgroundColor:'#dcfce7',color:'#166534'},children:LoanService.getPaymentTypeDisplayName(repayment.payment_type)})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCardBody,children:[/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCardRow,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Montant:\"}),/*#__PURE__*/_jsxs(\"strong\",{children:[repayment.amount.toLocaleString(),\" XAF\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCardRow,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Capital:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[repayment.capital_amount.toLocaleString(),\" XAF\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCardRow,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Int\\xE9r\\xEAts:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[repayment.interest_amount.toLocaleString(),\" XAF\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCardRow,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Date:\"}),/*#__PURE__*/_jsx(\"span\",{children:new Date(repayment.date).toLocaleDateString('fr-FR')})]}),repayment.processed_by_name&&/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCardRow,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Trait\\xE9 par:\"}),/*#__PURE__*/_jsx(\"span\",{children:repayment.processed_by_name})]})]})]},repayment.id))}):/*#__PURE__*/_jsx(\"div\",{style:styles.tableContainer,children:/*#__PURE__*/_jsxs(\"table\",{style:styles.table,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Pr\\xEAt\"}),/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Emprunteur\"}),/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Montant\"}),/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Capital\"}),/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Int\\xE9r\\xEAts\"}),/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Type\"}),/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Trait\\xE9 par\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:repayments.map(repayment=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{style:styles.td,children:[\"#\",repayment.loan_request]}),/*#__PURE__*/_jsx(\"td\",{style:styles.td,children:repayment.loan_member_name}),/*#__PURE__*/_jsxs(\"td\",{style:styles.td,children:[repayment.amount.toLocaleString(),\" XAF\"]}),/*#__PURE__*/_jsxs(\"td\",{style:styles.td,children:[repayment.capital_amount.toLocaleString(),\" XAF\"]}),/*#__PURE__*/_jsxs(\"td\",{style:styles.td,children:[repayment.interest_amount.toLocaleString(),\" XAF\"]}),/*#__PURE__*/_jsx(\"td\",{style:styles.td,children:/*#__PURE__*/_jsx(\"span\",{style:{...styles.chip,backgroundColor:'#dcfce7',color:'#166534'},children:LoanService.getPaymentTypeDisplayName(repayment.payment_type)})}),/*#__PURE__*/_jsx(\"td\",{style:styles.td,children:new Date(repayment.date).toLocaleDateString('fr-FR')}),/*#__PURE__*/_jsx(\"td\",{style:styles.td,children:repayment.processed_by_name||'-'})]},repayment.id))})]})})]});};// --- VUES DESKTOP & MOBILE POUR LES PRÊTS ---\nconst DesktopLoanTable=_ref2=>{let{loans,members,hasPermission,onStatusUpdate,onRepayment,getMemberName,getGuarantorNames,canAddRepayments}=_ref2;return/*#__PURE__*/_jsx(\"div\",{style:styles.tableContainer,children:/*#__PURE__*/_jsxs(\"table\",{style:styles.table,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Membre\"}),/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Montant\"}),/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Solde\"}),/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Progression\"}),/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Statut\"}),/*#__PURE__*/_jsx(\"th\",{style:styles.th,children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:loans.map(loan=>{const progressPercentage=(loan.total_repaid/loan.total_amount_with_interest*100).toFixed(1);return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{style:styles.td,children:loan.member_name}),/*#__PURE__*/_jsxs(\"td\",{style:styles.td,children:[loan.amount.toLocaleString(),\" XAF\"]}),/*#__PURE__*/_jsx(\"td\",{style:styles.td,children:loan.status==='approved'?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[loan.remaining_balance.toLocaleString(),\" XAF\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',color:'#6b7280'},children:[\"sur \",loan.total_amount_with_interest.toLocaleString(),\" XAF\"]})]}):loan.total_amount_with_interest.toLocaleString()+' XAF'}),/*#__PURE__*/_jsx(\"td\",{style:styles.td,children:loan.status==='approved'&&/*#__PURE__*/_jsxs(\"div\",{style:{width:'100px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#e5e7eb',borderRadius:'4px',height:'8px',overflow:'hidden'},children:/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:loan.is_fully_repaid?'#22c55e':'#3b82f6',height:'100%',width:`${progressPercentage}%`,transition:'width 0.3s ease'}})}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',marginTop:'2px',textAlign:'center'},children:[progressPercentage,\"%\"]})]})}),/*#__PURE__*/_jsx(\"td\",{style:styles.td,children:/*#__PURE__*/_jsx(StatusChip,{status:LoanService.getStatusDisplayName(loan.status)})}),/*#__PURE__*/_jsx(\"td\",{style:styles.td,children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px',flexWrap:'wrap'},children:[loan.status==='pending'&&hasPermission('approve_loans')&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>onStatusUpdate(loan.id,'approved'),style:{...styles.actionButton,backgroundColor:'#22c55e'},title:\"Approuver\",children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCheck})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onStatusUpdate(loan.id,'rejected'),style:{...styles.actionButton,backgroundColor:'#ef4444'},title:\"Rejeter\",children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faTimes})})]}),loan.status==='approved'&&!loan.is_fully_repaid&&canAddRepayments&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>onRepayment(loan),style:{...styles.actionButton,backgroundColor:'#3b82f6'},title:\"Rembourser\",children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faMoneyBillWave})})]})})]},loan.id);})})]})});};const MobileLoanList=_ref3=>{let{loans,members,hasPermission,onStatusUpdate,onRepayment,getMemberName,getGuarantorNames,canAddRepayments}=_ref3;return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',gap:'16px'},children:loans.map(loan=>{const progressPercentage=(loan.total_repaid/loan.total_amount_with_interest*100).toFixed(1);return/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCard,children:[/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCardHeader,children:[/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:'bold',color:'#1f2937'},children:loan.member_name}),/*#__PURE__*/_jsx(StatusChip,{status:LoanService.getStatusDisplayName(loan.status)})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCardBody,children:[/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCardRow,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Montant initial:\"}),/*#__PURE__*/_jsxs(\"strong\",{children:[loan.amount.toLocaleString(),\" XAF\"]})]}),loan.status==='approved'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCardRow,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Solde restant:\"}),/*#__PURE__*/_jsxs(\"strong\",{style:{color:loan.is_fully_repaid?'#22c55e':'#ef4444'},children:[loan.remaining_balance.toLocaleString(),\" XAF\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCardRow,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Progression:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[progressPercentage,\"% rembours\\xE9\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.mobileCardFooter,children:[loan.status==='pending'&&hasPermission('approve_loans')&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>onStatusUpdate(loan.id,'approved'),style:{...styles.button,flex:1,backgroundColor:'#22c55e'},children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCheck,style:{marginRight:'8px'}}),\"Approuver\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>onStatusUpdate(loan.id,'rejected'),style:{...styles.button,flex:1,backgroundColor:'#ef4444'},children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faTimes,style:{marginRight:'8px'}}),\"Rejeter\"]})]}),loan.status==='approved'&&!loan.is_fully_repaid&&canAddRepayments&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>onRepayment(loan),style:{...styles.button,flex:1,backgroundColor:'#3b82f6'},children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faMoneyBillWave,style:{marginRight:'8px'}}),\"Rembourser\"]})]})]},loan.id);})});};// --- SOUS-COMPOSANTS & STYLES ---\nconst StatCard=_ref4=>{let{title,value}=_ref4;return/*#__PURE__*/_jsxs(\"div\",{style:{...styles.card,flex:'1 1 250px',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"h4\",{style:styles.statTitle,children:title}),/*#__PURE__*/_jsx(\"p\",{style:styles.statValue,children:value})]});};const StatusChip=_ref5=>{let{status}=_ref5;const statusColors={'En attente':{backgroundColor:'#fef3c7',color:'#92400e'},'Approuvé':{backgroundColor:'#dcfce7',color:'#166534'},'Rejeté':{backgroundColor:'#fee2e2',color:'#991b1b'},'Remboursé':{backgroundColor:'#e0e7ff',color:'#3730a3'}};return/*#__PURE__*/_jsx(\"span\",{style:{...styles.chip,...statusColors[status]},children:status});};const ModalInput=_ref6=>{let{label,...props}=_ref6;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:styles.modalLabel,children:label}),/*#__PURE__*/_jsx(\"input\",{style:styles.modalInput,...props})]});};const ModalSelect=_ref7=>{let{label,children,...props}=_ref7;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:styles.modalLabel,children:label}),/*#__PURE__*/_jsx(\"select\",{style:styles.modalInput,...props,children:children})]});};const ModalTextarea=_ref8=>{let{label,...props}=_ref8;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:styles.modalLabel,children:label}),/*#__PURE__*/_jsx(\"textarea\",{style:{...styles.modalInput,height:'80px'},...props})]});};const styles={page:{fontFamily:'Arial, sans-serif',padding:'16px',backgroundColor:'#f3f4f6',minHeight:'100vh'},header:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'24px',flexWrap:'wrap',gap:'16px'},headerTitle:{fontSize:'24px',fontWeight:'bold',color:'#1f2937',margin:0},loadingText:{fontSize:'16px',fontWeight:'normal',color:'#6b7280'},errorContainer:{textAlign:'center',padding:'40px',backgroundColor:'white',borderRadius:'12px',boxShadow:'0 4px 12px rgba(0, 0, 0, 0.08)'},loadingContainer:{textAlign:'center',padding:'40px'},emptyState:{textAlign:'center',padding:'40px',backgroundColor:'white',borderRadius:'12px',boxShadow:'0 4px 12px rgba(0, 0, 0, 0.08)'},statSection:{display:'flex',gap:'16px',flexWrap:'wrap',marginBottom:'24px'},card:{backgroundColor:'white',padding:'16px',borderRadius:'12px',boxShadow:'0 4px 12px rgba(0, 0, 0, 0.08)'},statTitle:{margin:0,color:'#4b5563',fontSize:'14px',fontWeight:'600'},statValue:{margin:'8px 0 0 0',color:'#1e3a8a',fontSize:'22px',fontWeight:'bold'},// Styles des onglets\ntabSection:{display:'flex',marginBottom:'24px',backgroundColor:'white',borderRadius:'12px',overflow:'hidden',boxShadow:'0 4px 12px rgba(0, 0, 0, 0.08)'},tabButton:{flex:1,padding:'12px 24px',border:'none',fontSize:'14px',fontWeight:'600',cursor:'pointer',transition:'all 0.2s',display:'flex',alignItems:'center',justifyContent:'center'},activeTab:{backgroundColor:'#3b82f6',color:'white'},inactiveTab:{backgroundColor:'white',color:'#6b7280'},controlsSection:{marginBottom:'24px'},button:{padding:'10px 16px',backgroundColor:'#2563eb',color:'white',border:'none',borderRadius:'8px',cursor:'pointer',fontWeight:'600',display:'flex',alignItems:'center',justifyContent:'center',transition:'background-color 0.2s',fontSize:'14px'},permissionInfo:{backgroundColor:'#e0f2fe',padding:'12px',borderRadius:'8px',marginTop:'16px',border:'1px solid #0891b2'},tableContainer:{backgroundColor:'white',borderRadius:'12px',boxShadow:'0 4px 12px rgba(0, 0, 0, 0.08)',overflowX:'auto'},table:{width:'100%',borderCollapse:'collapse'},th:{padding:'12px 16px',textAlign:'left',fontSize:'14px',color:'#4b5563',backgroundColor:'#f9fafb',borderBottom:'1px solid #e5e7eb',fontWeight:'600'},td:{padding:'12px 16px',fontSize:'14px',color:'#374151',borderBottom:'1px solid #e5e7eb',verticalAlign:'middle'},chip:{padding:'4px 12px',borderRadius:'9999px',fontWeight:'600',fontSize:'12px'},actionButton:{padding:'8px 12px',border:'none',borderRadius:'6px',color:'white',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'14px',fontWeight:'bold'},// Styles des modals\nmodalOverlay:{position:'fixed',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(0, 0, 0, 0.6)',display:'flex',justifyContent:'center',alignItems:'center',zIndex:1000,padding:'16px'},modalContent:{backgroundColor:'white',padding:'24px',borderRadius:'12px',width:'100%',maxWidth:'600px',boxShadow:'0 8px 16px rgba(0, 0, 0, 0.2)',maxHeight:'90vh',display:'flex',flexDirection:'column'},modalTitle:{fontSize:'22px',fontWeight:'bold',marginBottom:'24px',color:'#1f2937',flexShrink:0,textAlign:'center'},modalForm:{flexGrow:1,overflowY:'auto',paddingRight:'12px',marginRight:'-12px',display:'flex',flexDirection:'column',gap:'16px'},modalLabel:{display:'block',marginBottom:'8px',fontWeight:'600',color:'#374151',fontSize:'14px'},modalInput:{width:'100%',padding:'10px',border:'1px solid #d1d5db',borderRadius:'8px',boxSizing:'border-box',fontSize:'16px'},disabledInput:{width:'100%',padding:'10px',border:'1px solid #e5e7eb',backgroundColor:'#f9fafb',color:'#6b7280',borderRadius:'8px',boxSizing:'border-box',fontSize:'16px'},modalActions:{display:'flex',justifyContent:'flex-end',gap:'12px',marginTop:'24px',flexShrink:0},formError:{color:'#ef4444',backgroundColor:'#fee2e2',padding:'10px',borderRadius:'8px',textAlign:'center',marginBottom:'16px'},// Styles spécifiques aux remboursements\nloanDetailsBox:{backgroundColor:'#f3f4f6',padding:'12px',borderRadius:'8px',fontSize:'14px',lineHeight:1.6,borderLeft:'4px solid #3b82f6'},loanInfoBox:{backgroundColor:'#f0f9ff',padding:'16px',borderRadius:'8px',fontSize:'14px',lineHeight:1.6,borderLeft:'4px solid #0ea5e9'},calculationBox:{backgroundColor:'#f0fdf4',padding:'12px',borderRadius:'8px',fontSize:'14px',lineHeight:1.6,borderLeft:'4px solid #22c55e'},// Styles mobile\nmobileCard:{backgroundColor:'white',borderRadius:'12px',boxShadow:'0 4px 12px rgba(0, 0, 0, 0.08)',overflow:'hidden'},mobileCardHeader:{display:'flex',justifyContent:'space-between',alignItems:'center',padding:'12px 16px',backgroundColor:'#f9fafb',borderBottom:'1px solid #e5e7eb'},mobileCardBody:{padding:'16px',display:'flex',flexDirection:'column',gap:'10px'},mobileCardRow:{display:'flex',justifyContent:'space-between',fontSize:'14px'},mobileCardFooter:{padding:'12px 16px',backgroundColor:'#f9fafb',borderTop:'1px solid #e5e7eb',display:'flex',gap:'12px'}};export default Loans;","map":{"version":3,"names":["React","useState","useEffect","useMemo","useAuth","useNavigate","FontAwesomeIcon","faPlus","faCheck","faTimes","faMoneyBillWave","faHistory","faCalculator","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","useWindowSize","size","setSize","window","innerWidth","handleResize","addEventListener","removeEventListener","width","MOBILE_BREAKPOINT","API_BASE_URL","LoanService","getMaxLoanAmount","berryPoints","getInterestRate","amount","calculateTotalToRepay","interestRate","getStatusDisplayName","status","statusMap","getPaymentTypeDisplayName","type","typeMap","Loans","user","hasPermission","navigate","loans","setLoans","members","setMembers","loading","setLoading","error","setError","isLoanModalOpen","setIsLoanModalOpen","isSubmitting","setIsSubmitting","formError","setFormError","repayments","setRepayments","isRepaymentModalOpen","setIsRepaymentModalOpen","selectedLoanForRepayment","setSelectedLoanForRepayment","activeTab","setActiveTab","initialLoanFormState","member","justification","guarantors","initialRepaymentFormState","loan_request","payment_type","notes","newLoanRequest","setNewLoanRequest","newRepayment","setNewRepayment","guarantor1Id","setGuarantor1Id","guarantor2Id","setGuarantor2Id","selectedMember","find","m","id","loanDetails","maxAmount","berry_score","totalToRepay","toLocaleString","repaymentCalculations","loan","capitalAmount","interestAmount","remaining_balance","remaining_interest","minimum_monthly_payment","remaining_capital","loanStats","pendingCount","filter","l","length","activeLoanAmount","reduce","sum","repaidAmount","total_repaid","fetchLoans","response","fetch","headers","token","ok","Error","data","json","err","message","console","fetchRepayments","fetchMembers","isMobile","style","styles","page","children","errorContainer","handleOpenLoanModal","alert","currentMember","parseInt","handleStatusUpdate","method","body","JSON","stringify","handleSaveLoanRequest","loanData","interest_rate","errorData","handleOpenRepaymentModal","handleSaveRepayment","repaymentData","capital_amount","interest_amount","getMemberName","memberId","first_name","last_name","getGuarantorNames","guarantorIds","map","join","canViewStats","canAddLoans","canApproveLoans","canAddRepayments","onClick","button","header","headerTitle","loadingText","backgroundColor","statSection","StatCard","title","value","tabSection","tabButton","inactiveTab","icon","marginRight","controlsSection","loadingContainer","emptyState","MobileLoanList","onStatusUpdate","onRepayment","DesktopLoanTable","RepaymentSection","permissionInfo","modalOverlay","modalContent","modalTitle","modalForm","ModalSelect","label","onChange","e","target","disabled","modalLabel","disabledInput","ModalInput","step","parseFloat","loanDetailsBox","color","ModalTextarea","placeholder","modalActions","loanInfoBox","member_name","calculationBox","_ref","marginBottom","display","flexDirection","gap","repayment","mobileCard","mobileCardHeader","fontWeight","loan_member_name","chip","mobileCardBody","mobileCardRow","Date","date","toLocaleDateString","processed_by_name","tableContainer","table","th","td","_ref2","progressPercentage","total_amount_with_interest","toFixed","fontSize","borderRadius","height","overflow","is_fully_repaid","transition","marginTop","textAlign","StatusChip","flexWrap","actionButton","_ref3","mobileCardFooter","flex","_ref4","card","statTitle","statValue","_ref5","statusColors","_ref6","props","modalInput","_ref7","_ref8","fontFamily","padding","minHeight","justifyContent","alignItems","margin","boxShadow","border","cursor","overflowX","borderCollapse","borderBottom","verticalAlign","position","top","left","right","bottom","zIndex","maxWidth","maxHeight","flexShrink","flexGrow","overflowY","paddingRight","boxSizing","lineHeight","borderLeft","borderTop"],"sources":["D:/Projects/FriendlyBanks/frontend/src/components/Loans.tsx"],"sourcesContent":["import React, { useState, useEffect, useMemo, ReactNode, InputHTMLAttributes, SelectHTMLAttributes, TextareaHTMLAttributes, ChangeEvent } from 'react';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faPlus, faCheck, faTimes, faMoneyBillWave, faHistory, faCalculator } from '@fortawesome/free-solid-svg-icons';\r\n\r\n// --- HOOK POUR LA RESPONSIVITÉ ---\r\nconst useWindowSize = () => {\r\n  const [size, setSize] = useState([window.innerWidth]);\r\n  useEffect(() => {\r\n    const handleResize = () => setSize([window.innerWidth]);\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n  return { width: size[0] };\r\n};\r\n\r\n// --- INTERFACES ADAPTÉES À L'API DJANGO ---\r\ninterface ApiLoanRequest {\r\n  id: number;\r\n  member: number;\r\n  member_name: string;\r\n  amount: number;\r\n  justification: string;\r\n  date_requested: string;\r\n  status: 'pending' | 'approved' | 'rejected' | 'repaid';\r\n  interest_rate: number;\r\n  repayment_due_date: string | null;\r\n  guarantors: number[];\r\n  guarantor_names: string[];\r\n  \r\n  // Champs calculés pour le remboursement\r\n  total_amount_with_interest: number;\r\n  total_repaid: number;\r\n  remaining_balance: number;\r\n  capital_repaid: number;\r\n  interest_repaid: number;\r\n  remaining_capital: number;\r\n  remaining_interest: number;\r\n  is_fully_repaid: boolean;\r\n  minimum_monthly_payment: number;\r\n  repayments: ApiLoanRepayment[];\r\n}\r\n\r\ninterface ApiLoanRepayment {\r\n  id: number;\r\n  loan_request: number;\r\n  amount: number;\r\n  capital_amount: number;\r\n  interest_amount: number;\r\n  payment_type: 'partial' | 'interest_only' | 'full';\r\n  date: string;\r\n  notes: string;\r\n  processed_by_name: string;\r\n  loan_member_name: string;\r\n}\r\n\r\ninterface ApiMember {\r\n  id: number;\r\n  user: {\r\n    id: number;\r\n    username: string;\r\n    email: string;\r\n    first_name: string;\r\n    last_name: string;\r\n    role: string;\r\n  };\r\n  berry_score: number;\r\n  shares: number;\r\n}\r\n\r\ninterface LoanFormData {\r\n  member: number;\r\n  amount: number;\r\n  justification: string;\r\n  guarantors: number[];\r\n}\r\n\r\ninterface RepaymentFormData {\r\n  loan_request: number;\r\n  amount: number;\r\n  payment_type: 'partial' | 'interest_only' | 'full';\r\n  notes: string;\r\n}\r\n\r\n// --- CONSTANTES ---\r\nconst MOBILE_BREAKPOINT = 768;\r\nconst API_BASE_URL = 'http://172.30.240.1:8000/api';\r\n\r\n// --- SERVICE DE LOGIQUE MÉTIER SELON LA CHARTE FRIENDLY BANKS ---\r\nconst LoanService = {\r\n  getMaxLoanAmount: (berryPoints: number) => {\r\n    if (berryPoints >= 10 && berryPoints <= 100) return 60000;\r\n    if (berryPoints > 100 && berryPoints <= 199) return 120000;\r\n    if (berryPoints >= 200 && berryPoints <= 499) return 300000;\r\n    if (berryPoints >= 500) return 500000;\r\n    return 0;\r\n  },\r\n  \r\n  getInterestRate: (amount: number) => {\r\n    if (amount > 0 && amount < 40000) return 10;\r\n    if (amount >= 40000 && amount < 100000) return 8;\r\n    if (amount >= 100000) return 6;\r\n    return 0;\r\n  },\r\n\r\n  calculateTotalToRepay: (amount: number, interestRate: number) => {\r\n    return amount * (1 + interestRate / 100);\r\n  },\r\n\r\n  getStatusDisplayName: (status: string) => {\r\n    const statusMap: { [key: string]: string } = {\r\n      'pending': 'En attente',\r\n      'approved': 'Approuvé',\r\n      'rejected': 'Rejeté',\r\n      'repaid': 'Remboursé'\r\n    };\r\n    return statusMap[status] || status;\r\n  },\r\n\r\n  getPaymentTypeDisplayName: (type: string) => {\r\n    const typeMap: { [key: string]: string } = {\r\n      'partial': 'Remboursement partiel',\r\n      'interest_only': 'Intérêts uniquement',\r\n      'full': 'Remboursement complet'\r\n    };\r\n    return typeMap[type] || type;\r\n  }\r\n};\r\n\r\n// --- COMPOSANT PRINCIPAL ---\r\nconst Loans: React.FC = () => {\r\n  const { user, hasPermission } = useAuth();\r\n  const navigate = useNavigate();\r\n\r\n  // --- ÉTATS PRÊTS ---\r\n  const [loans, setLoans] = useState<ApiLoanRequest[]>([]);\r\n  const [members, setMembers] = useState<ApiMember[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [isLoanModalOpen, setIsLoanModalOpen] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [formError, setFormError] = useState('');\r\n  \r\n  // --- ÉTATS REMBOURSEMENTS ---\r\n  const [repayments, setRepayments] = useState<ApiLoanRepayment[]>([]);\r\n  const [isRepaymentModalOpen, setIsRepaymentModalOpen] = useState(false);\r\n  const [selectedLoanForRepayment, setSelectedLoanForRepayment] = useState<ApiLoanRequest | null>(null);\r\n  const [activeTab, setActiveTab] = useState<'loans' | 'repayments'>('loans');\r\n  \r\n  const initialLoanFormState: LoanFormData = {\r\n    member: 0,\r\n    amount: 5000,\r\n    justification: '',\r\n    guarantors: []\r\n  };\r\n  \r\n  const initialRepaymentFormState: RepaymentFormData = {\r\n    loan_request: 0,\r\n    amount: 0,\r\n    payment_type: 'partial',\r\n    notes: ''\r\n  };\r\n  \r\n  const [newLoanRequest, setNewLoanRequest] = useState(initialLoanFormState);\r\n  const [newRepayment, setNewRepayment] = useState(initialRepaymentFormState);\r\n  const [guarantor1Id, setGuarantor1Id] = useState<number>(0);\r\n  const [guarantor2Id, setGuarantor2Id] = useState<number>(0);\r\n\r\n  // --- CALCULS MEMOIZÉS ---\r\n  const selectedMember = useMemo(() => {\r\n    return members.find(m => m.id === newLoanRequest.member);\r\n  }, [newLoanRequest.member, members]);\r\n  \r\n  const loanDetails = useMemo(() => {\r\n    if (!selectedMember) return null;\r\n    \r\n    const maxAmount = LoanService.getMaxLoanAmount(selectedMember.berry_score);\r\n    const interestRate = LoanService.getInterestRate(newLoanRequest.amount);\r\n    const totalToRepay = LoanService.calculateTotalToRepay(newLoanRequest.amount, interestRate);\r\n    \r\n    let error = '';\r\n    if (newLoanRequest.amount > maxAmount) {\r\n      error = `Le montant dépasse votre plafond de prêt de ${maxAmount.toLocaleString()} XAF.`;\r\n    }\r\n    \r\n    return { maxAmount, interestRate, totalToRepay, error };\r\n  }, [newLoanRequest.amount, selectedMember]);\r\n\r\n  const repaymentCalculations = useMemo(() => {\r\n    if (!selectedLoanForRepayment) return null;\r\n    \r\n    const loan = selectedLoanForRepayment;\r\n    const amount = newRepayment.amount;\r\n    \r\n    if (amount <= 0) return null;\r\n    \r\n    let capitalAmount = 0;\r\n    let interestAmount = 0;\r\n    let error = '';\r\n    \r\n    if (amount > loan.remaining_balance) {\r\n      error = `Le montant dépasse le solde restant (${loan.remaining_balance.toLocaleString()} XAF)`;\r\n    } else if (newRepayment.payment_type === 'interest_only') {\r\n      if (amount > loan.remaining_interest) {\r\n        error = `Le montant dépasse les intérêts restants (${loan.remaining_interest.toLocaleString()} XAF)`;\r\n      } else {\r\n        interestAmount = amount;\r\n        capitalAmount = 0;\r\n      }\r\n    } else {\r\n      // Remboursement partiel ou complet\r\n      if (amount <= loan.remaining_interest) {\r\n        interestAmount = amount;\r\n        capitalAmount = 0;\r\n      } else {\r\n        interestAmount = loan.remaining_interest;\r\n        capitalAmount = amount - loan.remaining_interest;\r\n        \r\n        // Vérifier le minimum de 10% du capital pour les remboursements de capital\r\n        if (capitalAmount > 0 && capitalAmount < loan.minimum_monthly_payment && loan.remaining_capital > loan.minimum_monthly_payment) {\r\n          error = `Le remboursement de capital doit être d'au moins ${loan.minimum_monthly_payment.toLocaleString()} XAF (10% du capital restant)`;\r\n        }\r\n      }\r\n    }\r\n    \r\n    return { capitalAmount, interestAmount, error };\r\n  }, [newRepayment.amount, newRepayment.payment_type, selectedLoanForRepayment]);\r\n\r\n  const loanStats = useMemo(() => ({\r\n    pendingCount: loans.filter(l => l.status === 'pending').length,\r\n    activeLoanAmount: loans.filter(l => l.status === 'approved').reduce((sum, l) => sum + l.remaining_balance, 0),\r\n    repaidAmount: loans.reduce((sum, l) => sum + l.total_repaid, 0),\r\n  }), [loans]);\r\n  \r\n  // --- FONCTIONS API ---\r\n  const fetchLoans = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      \r\n      const response = await fetch(`${API_BASE_URL}/loan-requests/`, {\r\n        headers: {\r\n          'Authorization': `Bearer ${user?.token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Erreur HTTP: ${response.status}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      setLoans(data);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Erreur lors du chargement des prêts');\r\n      console.error('Erreur lors du chargement des prêts:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchRepayments = async () => {\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/loan-repayments/`, {\r\n        headers: {\r\n          'Authorization': `Bearer ${user?.token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Erreur HTTP: ${response.status}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      setRepayments(data);\r\n    } catch (err) {\r\n      console.error('Erreur lors du chargement des remboursements:', err);\r\n    }\r\n  };\r\n\r\n  const fetchMembers = async () => {\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/members/`, {\r\n        headers: {\r\n          'Authorization': `Bearer ${user?.token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Erreur HTTP: ${response.status}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      setMembers(data);\r\n    } catch (err) {\r\n      console.error('Erreur lors du chargement des membres:', err);\r\n    }\r\n  };\r\n\r\n  // Charger les données au montage du composant\r\n  useEffect(() => {\r\n    if (user?.token) {\r\n      fetchLoans();\r\n      fetchRepayments();\r\n      fetchMembers();\r\n    }\r\n  }, [user?.token]);\r\n\r\n  const { width } = useWindowSize();\r\n  const isMobile = width < MOBILE_BREAKPOINT;\r\n\r\n  // --- VÉRIFICATION DES PERMISSIONS ---\r\n  if (!hasPermission('view_loans')) {\r\n    return (\r\n      <div style={styles.page}>\r\n        <div style={styles.errorContainer}>\r\n          <h3>Accès refusé</h3>\r\n          <p>Vous n'avez pas la permission de consulter les prêts.</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // --- GESTIONNAIRES D'ÉVÉNEMENTS PRÊTS ---\r\n  const handleOpenLoanModal = () => {\r\n    if (!hasPermission('add_loan_requests')) {\r\n      alert(\"Vous n'avez pas la permission de faire une demande de prêt.\");\r\n      return;\r\n    }\r\n\r\n    const currentMember = members.find(m => m.user.id === parseInt(user?.id || '0'));\r\n    setNewLoanRequest({\r\n      ...initialLoanFormState,\r\n      member: currentMember?.id || 0\r\n    });\r\n    setGuarantor1Id(0);\r\n    setGuarantor2Id(0);\r\n    setFormError('');\r\n    setIsLoanModalOpen(true);\r\n  };\r\n\r\n  const handleStatusUpdate = async (id: number, status: 'approved' | 'rejected') => {\r\n    if (!hasPermission('approve_loans')) {\r\n      alert(\"Vous n'avez pas la permission d'approuver des prêts.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/loan-requests/${id}/`, {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Authorization': `Bearer ${user?.token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ status }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Erreur lors de la mise à jour du statut');\r\n      }\r\n\r\n      await fetchLoans();\r\n      alert(`Prêt ${status === 'approved' ? 'approuvé' : 'rejeté'} avec succès`);\r\n      \r\n    } catch (err) {\r\n      console.error('Erreur lors de la mise à jour:', err);\r\n      alert('Erreur lors de la mise à jour du statut');\r\n    }\r\n  };\r\n\r\n  const handleSaveLoanRequest = async () => {\r\n    if (!selectedMember || !loanDetails || !newLoanRequest.justification || !guarantor1Id || !guarantor2Id) {\r\n      setFormError(\"Veuillez remplir tous les champs.\");\r\n      return;\r\n    }\r\n    \r\n    if (loanDetails.error) {\r\n      setFormError(loanDetails.error);\r\n      return;\r\n    }\r\n    \r\n    if (guarantor1Id === guarantor2Id || guarantor1Id === selectedMember.id || guarantor2Id === selectedMember.id) {\r\n      setFormError(\"Veuillez choisir deux avaliseurs distincts et différents de vous-même.\");\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    setFormError('');\r\n\r\n    try {\r\n      const loanData = {\r\n        member: newLoanRequest.member,\r\n        amount: newLoanRequest.amount,\r\n        justification: newLoanRequest.justification,\r\n        guarantors: [guarantor1Id, guarantor2Id],\r\n        interest_rate: loanDetails.interestRate\r\n      };\r\n\r\n      const response = await fetch(`${API_BASE_URL}/loan-requests/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${user?.token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(loanData),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.error || 'Erreur lors de la création de la demande');\r\n      }\r\n\r\n      await fetchLoans();\r\n      setIsLoanModalOpen(false);\r\n      alert('Demande de prêt soumise avec succès !');\r\n      \r\n    } catch (err) {\r\n      setFormError(err instanceof Error ? err.message : 'Erreur lors de la création');\r\n      console.error('Erreur lors de la création:', err);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  // --- GESTIONNAIRES D'ÉVÉNEMENTS REMBOURSEMENTS ---\r\n  const handleOpenRepaymentModal = (loan: ApiLoanRequest) => {\r\n    if (!hasPermission('add_repayments') && !hasPermission('manage_loans')) {\r\n      alert(\"Vous n'avez pas la permission d'effectuer des remboursements.\");\r\n      return;\r\n    }\r\n\r\n    if (loan.status !== 'approved') {\r\n      alert(\"Seuls les prêts approuvés peuvent faire l'objet de remboursements.\");\r\n      return;\r\n    }\r\n\r\n    setSelectedLoanForRepayment(loan);\r\n    setNewRepayment({\r\n      ...initialRepaymentFormState,\r\n      loan_request: loan.id,\r\n      amount: loan.minimum_monthly_payment\r\n    });\r\n    setFormError('');\r\n    setIsRepaymentModalOpen(true);\r\n  };\r\n\r\n  const handleSaveRepayment = async () => {\r\n    if (!selectedLoanForRepayment || !repaymentCalculations || repaymentCalculations.error) {\r\n      setFormError(repaymentCalculations?.error || \"Veuillez vérifier les données saisies.\");\r\n      return;\r\n    }\r\n\r\n    if (newRepayment.amount <= 0) {\r\n      setFormError(\"Le montant doit être positif.\");\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    setFormError('');\r\n\r\n    try {\r\n      const repaymentData = {\r\n        loan_request: newRepayment.loan_request,\r\n        amount: newRepayment.amount,\r\n        payment_type: newRepayment.payment_type,\r\n        notes: newRepayment.notes,\r\n        capital_amount: repaymentCalculations.capitalAmount,\r\n        interest_amount: repaymentCalculations.interestAmount\r\n      };\r\n\r\n      const response = await fetch(`${API_BASE_URL}/loan-repayments/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${user?.token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(repaymentData),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.error || 'Erreur lors de la création du remboursement');\r\n      }\r\n\r\n      await fetchLoans();\r\n      await fetchRepayments();\r\n      setIsRepaymentModalOpen(false);\r\n      alert('Remboursement effectué avec succès !');\r\n      \r\n    } catch (err) {\r\n      setFormError(err instanceof Error ? err.message : 'Erreur lors du remboursement');\r\n      console.error('Erreur lors du remboursement:', err);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const getMemberName = (memberId: number) => {\r\n    const member = members.find(m => m.id === memberId);\r\n    return member ? `${member.user.first_name} ${member.user.last_name}` : 'Membre inconnu';\r\n  };\r\n\r\n  const getGuarantorNames = (guarantorIds: number[]) => {\r\n    return guarantorIds.map(id => getMemberName(id)).join(', ');\r\n  };\r\n\r\n  // --- PERMISSIONS D'AFFICHAGE ---\r\n  const canViewStats = hasPermission('view_reports') || hasPermission('approve_loans');\r\n  const canAddLoans = hasPermission('add_loan_requests');\r\n  const canApproveLoans = hasPermission('approve_loans');\r\n  const canAddRepayments = hasPermission('add_repayments') || hasPermission('manage_loans');\r\n\r\n  // --- AFFICHAGE DE L'ERREUR ---\r\n  if (error && !loading) {\r\n    return (\r\n      <div style={styles.page}>\r\n        <div style={styles.errorContainer}>\r\n          <h3>Erreur de chargement</h3>\r\n          <p>{error}</p>\r\n          <button onClick={fetchLoans} style={styles.button}>\r\n            Réessayer\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // --- RENDU PRINCIPAL ---\r\n  return (\r\n    <div style={styles.page}>\r\n      <header style={styles.header}>\r\n        <h2 style={styles.headerTitle}>\r\n          Gestion des Prêts & Remboursements\r\n          {loading && <span style={styles.loadingText}> (Chargement...)</span>}\r\n        </h2>\r\n        <button onClick={() => navigate('/')} style={{...styles.button, backgroundColor: '#6b7280'}}>\r\n          ← Retour\r\n        </button>\r\n      </header>\r\n      \r\n      {canViewStats && (\r\n        <section style={styles.statSection}>\r\n          <StatCard title=\"Solde des Prêts Actifs\" value={`${loanStats.activeLoanAmount.toLocaleString()} XAF`} />\r\n          <StatCard title=\"Demandes en Attente\" value={loanStats.pendingCount} />\r\n          <StatCard title=\"Total Remboursé\" value={`${loanStats.repaidAmount.toLocaleString()} XAF`} />\r\n        </section>\r\n      )}\r\n\r\n      {/* Onglets */}\r\n      <section style={styles.tabSection}>\r\n        <button \r\n          onClick={() => setActiveTab('loans')} \r\n          style={{\r\n            ...styles.tabButton, \r\n            ...(activeTab === 'loans' ? styles.activeTab : styles.inactiveTab)\r\n          }}\r\n        >\r\n          <FontAwesomeIcon icon={faMoneyBillWave} style={{ marginRight: '8px' }} />\r\n          Prêts\r\n        </button>\r\n        <button \r\n          onClick={() => setActiveTab('repayments')} \r\n          style={{\r\n            ...styles.tabButton, \r\n            ...(activeTab === 'repayments' ? styles.activeTab : styles.inactiveTab)\r\n          }}\r\n        >\r\n          <FontAwesomeIcon icon={faHistory} style={{ marginRight: '8px' }} />\r\n          Remboursements\r\n        </button>\r\n      </section>\r\n\r\n      {/* Contenu des onglets */}\r\n      {activeTab === 'loans' ? (\r\n        <>\r\n          <section style={styles.controlsSection}>\r\n            {canAddLoans && (\r\n              <button onClick={handleOpenLoanModal} style={styles.button}>\r\n                <FontAwesomeIcon icon={faPlus} style={{ marginRight: '8px' }} />\r\n                Faire une Demande de Prêt\r\n              </button>\r\n            )}\r\n          </section>\r\n\r\n          {loading ? (\r\n            <div style={styles.loadingContainer}>\r\n              <p>Chargement des prêts...</p>\r\n            </div>\r\n          ) : loans.length === 0 ? (\r\n            <div style={styles.emptyState}>\r\n              <p>Aucune demande de prêt trouvée.</p>\r\n              {canAddLoans && <p>Commencez par faire votre première demande !</p>}\r\n            </div>\r\n          ) : (\r\n            isMobile ? (\r\n              <MobileLoanList \r\n                loans={loans} \r\n                members={members}\r\n                hasPermission={hasPermission} \r\n                onStatusUpdate={handleStatusUpdate} \r\n                onRepayment={handleOpenRepaymentModal}\r\n                getMemberName={getMemberName}\r\n                getGuarantorNames={getGuarantorNames}\r\n                canAddRepayments={canAddRepayments}\r\n              />\r\n            ) : (\r\n              <DesktopLoanTable \r\n                loans={loans} \r\n                members={members}\r\n                hasPermission={hasPermission} \r\n                onStatusUpdate={handleStatusUpdate} \r\n                onRepayment={handleOpenRepaymentModal}\r\n                getMemberName={getMemberName}\r\n                getGuarantorNames={getGuarantorNames}\r\n                canAddRepayments={canAddRepayments}\r\n              />\r\n            )\r\n          )}\r\n        </>\r\n      ) : (\r\n        <RepaymentSection \r\n          repayments={repayments}\r\n          loading={loading}\r\n          isMobile={isMobile}\r\n        />\r\n      )}\r\n\r\n      {/* Informations sur les permissions */}\r\n      {!canAddLoans && !canAddRepayments && (\r\n        <div style={styles.permissionInfo}>\r\n          <p>\r\n            <strong>Information :</strong> Vous pouvez consulter les prêts et remboursements mais pas en effectuer. \r\n            Contactez le Comité de Gestion pour plus d'informations.\r\n          </p>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal Demande de Prêt */}\r\n      {isLoanModalOpen && (\r\n        <div style={styles.modalOverlay}>\r\n          <div style={styles.modalContent}>\r\n            <h3 style={styles.modalTitle}>Nouvelle Demande de Prêt</h3>\r\n            {formError && <p style={styles.formError}>{formError}</p>}\r\n            \r\n            <div style={styles.modalForm}>\r\n              {hasPermission('create_loan_for_others') ? (\r\n                <ModalSelect \r\n                  label=\"Membre demandeur\" \r\n                  value={newLoanRequest.member} \r\n                  onChange={(e: ChangeEvent<HTMLSelectElement>) => setNewLoanRequest({\r\n                    ...newLoanRequest, \r\n                    member: parseInt(e.target.value)\r\n                  })}\r\n                  disabled={isSubmitting}\r\n                >\r\n                  <option value={0} disabled>Sélectionner un membre...</option>\r\n                  {members.map(m => (\r\n                    <option key={m.id} value={m.id}>\r\n                      {m.user.first_name} {m.user.last_name} ({m.berry_score} pts Berry)\r\n                    </option>\r\n                  ))}\r\n                </ModalSelect>\r\n              ) : (\r\n                <div>\r\n                  <label style={styles.modalLabel}>Membre demandeur</label>\r\n                  <div style={styles.disabledInput}>\r\n                    {selectedMember ? `${selectedMember.user.first_name} ${selectedMember.user.last_name}` : 'Membre Actuel'}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {selectedMember && (\r\n                <>\r\n                  <ModalInput \r\n                    label=\"Montant souhaité (XAF)\" \r\n                    type=\"number\" \r\n                    step=\"1000\" \r\n                    value={newLoanRequest.amount} \r\n                    onChange={(e: ChangeEvent<HTMLInputElement>) => setNewLoanRequest({\r\n                      ...newLoanRequest, \r\n                      amount: parseFloat(e.target.value) || 0\r\n                    })}\r\n                    disabled={isSubmitting}\r\n                  />\r\n                  \r\n                  {loanDetails && (\r\n                    <div style={styles.loanDetailsBox}>\r\n                      <p>Plafond de prêt: <strong>{loanDetails.maxAmount.toLocaleString()} XAF</strong></p>\r\n                      <p>Taux d'intérêt: <strong>{loanDetails.interestRate}%</strong></p>\r\n                      <p>Total à rembourser: <strong>{loanDetails.totalToRepay.toLocaleString()} XAF</strong></p>\r\n                      {loanDetails.error && <p style={{color: '#ef4444'}}>{loanDetails.error}</p>}\r\n                    </div>\r\n                  )}\r\n                  \r\n                  <ModalTextarea \r\n                    label=\"Motif de la demande (urgence avérée)\" \r\n                    value={newLoanRequest.justification} \r\n                    onChange={(e: ChangeEvent<HTMLTextAreaElement>) => setNewLoanRequest({\r\n                      ...newLoanRequest, \r\n                      justification: e.target.value\r\n                    })}\r\n                    placeholder=\"Décrivez précisément la nature de votre urgence...\"\r\n                    disabled={isSubmitting}\r\n                  />\r\n                  \r\n                  <ModalSelect \r\n                    label=\"Avaliseur / Garant 1\" \r\n                    value={guarantor1Id} \r\n                    onChange={(e: ChangeEvent<HTMLSelectElement>) => setGuarantor1Id(parseInt(e.target.value))}\r\n                    disabled={isSubmitting}\r\n                  >\r\n                    <option value={0} disabled>Sélectionner...</option>\r\n                    {members.filter(m => m.id !== newLoanRequest.member).map(m => (\r\n                      <option key={m.id} value={m.id}>\r\n                        {m.user.first_name} {m.user.last_name}\r\n                      </option>\r\n                    ))}\r\n                  </ModalSelect>\r\n                  \r\n                  <ModalSelect \r\n                    label=\"Avaliseur / Garant 2\" \r\n                    value={guarantor2Id} \r\n                    onChange={(e: ChangeEvent<HTMLSelectElement>) => setGuarantor2Id(parseInt(e.target.value))}\r\n                    disabled={isSubmitting}\r\n                  >\r\n                    <option value={0} disabled>Sélectionner...</option>\r\n                    {members.filter(m => m.id !== newLoanRequest.member).map(m => (\r\n                      <option key={m.id} value={m.id}>\r\n                        {m.user.first_name} {m.user.last_name}\r\n                      </option>\r\n                    ))}\r\n                  </ModalSelect>\r\n                </>\r\n              )}\r\n            </div>\r\n\r\n            <div style={styles.modalActions}>\r\n              <button \r\n                onClick={() => setIsLoanModalOpen(false)} \r\n                style={{...styles.button, backgroundColor: '#6b7280'}}\r\n                disabled={isSubmitting}\r\n              >\r\n                Annuler\r\n              </button>\r\n              <button \r\n                onClick={handleSaveLoanRequest} \r\n                style={styles.button}\r\n                disabled={isSubmitting}\r\n              >\r\n                {isSubmitting ? 'Soumission...' : 'Soumettre la Demande'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal Remboursement */}\r\n      {isRepaymentModalOpen && selectedLoanForRepayment && (\r\n        <div style={styles.modalOverlay}>\r\n          <div style={styles.modalContent}>\r\n            <h3 style={styles.modalTitle}>Effectuer un Remboursement</h3>\r\n            {formError && <p style={styles.formError}>{formError}</p>}\r\n            \r\n            <div style={styles.modalForm}>\r\n              <div style={styles.loanInfoBox}>\r\n                <h4>Informations du Prêt #{selectedLoanForRepayment.id}</h4>\r\n                <p><strong>Emprunteur :</strong> {selectedLoanForRepayment.member_name}</p>\r\n                <p><strong>Montant initial :</strong> {selectedLoanForRepayment.amount.toLocaleString()} XAF</p>\r\n                <p><strong>Solde restant :</strong> {selectedLoanForRepayment.remaining_balance.toLocaleString()} XAF</p>\r\n                <p><strong>Capital restant :</strong> {selectedLoanForRepayment.remaining_capital.toLocaleString()} XAF</p>\r\n                <p><strong>Intérêts restants :</strong> {selectedLoanForRepayment.remaining_interest.toLocaleString()} XAF</p>\r\n                <p><strong>Paiement minimum :</strong> {selectedLoanForRepayment.minimum_monthly_payment.toLocaleString()} XAF</p>\r\n              </div>\r\n\r\n              <ModalSelect \r\n                label=\"Type de remboursement\" \r\n                value={newRepayment.payment_type} \r\n                onChange={(e: ChangeEvent<HTMLSelectElement>) => setNewRepayment({\r\n                  ...newRepayment, \r\n                  payment_type: e.target.value as 'partial' | 'interest_only' | 'full'\r\n                })}\r\n                disabled={isSubmitting}\r\n              >\r\n                <option value=\"partial\">Remboursement partiel</option>\r\n                <option value=\"interest_only\">Intérêts uniquement</option>\r\n                <option value=\"full\">Remboursement complet</option>\r\n              </ModalSelect>\r\n\r\n              <ModalInput \r\n                label=\"Montant à rembourser (XAF)\" \r\n                type=\"number\" \r\n                step=\"100\" \r\n                value={newRepayment.amount} \r\n                onChange={(e: ChangeEvent<HTMLInputElement>) => setNewRepayment({\r\n                  ...newRepayment, \r\n                  amount: parseFloat(e.target.value) || 0\r\n                })}\r\n                disabled={isSubmitting}\r\n              />\r\n\r\n              {repaymentCalculations && (\r\n                <div style={styles.calculationBox}>\r\n                  <h4><FontAwesomeIcon icon={faCalculator} /> Répartition du remboursement :</h4>\r\n                  <p><strong>Capital :</strong> {repaymentCalculations.capitalAmount.toLocaleString()} XAF</p>\r\n                  <p><strong>Intérêts :</strong> {repaymentCalculations.interestAmount.toLocaleString()} XAF</p>\r\n                  {repaymentCalculations.error && (\r\n                    <p style={{color: '#ef4444'}}>{repaymentCalculations.error}</p>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              <ModalTextarea \r\n                label=\"Notes (optionnel)\" \r\n                value={newRepayment.notes} \r\n                onChange={(e: ChangeEvent<HTMLTextAreaElement>) => setNewRepayment({\r\n                  ...newRepayment, \r\n                  notes: e.target.value\r\n                })}\r\n                placeholder=\"Notes sur ce remboursement...\"\r\n                disabled={isSubmitting}\r\n              />\r\n            </div>\r\n\r\n            <div style={styles.modalActions}>\r\n              <button \r\n                onClick={() => setIsRepaymentModalOpen(false)} \r\n                style={{...styles.button, backgroundColor: '#6b7280'}}\r\n                disabled={isSubmitting}\r\n              >\r\n                Annuler\r\n              </button>\r\n              <button \r\n                onClick={handleSaveRepayment} \r\n                style={styles.button}\r\n                disabled={isSubmitting || (repaymentCalculations?.error ? true : false)}\r\n              >\r\n                {isSubmitting ? 'Traitement...' : 'Effectuer le Remboursement'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// --- COMPOSANTS SPÉCIALISÉS ---\r\n\r\n// Section Remboursements\r\nconst RepaymentSection: React.FC<{\r\n  repayments: ApiLoanRepayment[];\r\n  loading: boolean;\r\n  isMobile: boolean;\r\n}> = ({ repayments, loading, isMobile }) => (\r\n  <div>\r\n    <h3 style={{marginBottom: '16px', color: '#1f2937'}}>Historique des Remboursements</h3>\r\n    \r\n    {loading ? (\r\n      <div style={styles.loadingContainer}>\r\n        <p>Chargement des remboursements...</p>\r\n      </div>\r\n    ) : repayments.length === 0 ? (\r\n      <div style={styles.emptyState}>\r\n        <p>Aucun remboursement enregistré.</p>\r\n      </div>\r\n    ) : isMobile ? (\r\n      <div style={{display: 'flex', flexDirection: 'column', gap: '16px'}}>\r\n        {repayments.map(repayment => (\r\n          <div key={repayment.id} style={styles.mobileCard}>\r\n            <div style={styles.mobileCardHeader}>\r\n              <span style={{fontWeight: 'bold'}}>\r\n                Prêt #{repayment.loan_request} - {repayment.loan_member_name}\r\n              </span>\r\n              <span style={{...styles.chip, backgroundColor: '#dcfce7', color: '#166534'}}>\r\n                {LoanService.getPaymentTypeDisplayName(repayment.payment_type)}\r\n              </span>\r\n            </div>\r\n            <div style={styles.mobileCardBody}>\r\n              <div style={styles.mobileCardRow}>\r\n                <span>Montant:</span> \r\n                <strong>{repayment.amount.toLocaleString()} XAF</strong>\r\n              </div>\r\n              <div style={styles.mobileCardRow}>\r\n                <span>Capital:</span> \r\n                <span>{repayment.capital_amount.toLocaleString()} XAF</span>\r\n              </div>\r\n              <div style={styles.mobileCardRow}>\r\n                <span>Intérêts:</span> \r\n                <span>{repayment.interest_amount.toLocaleString()} XAF</span>\r\n              </div>\r\n              <div style={styles.mobileCardRow}>\r\n                <span>Date:</span> \r\n                <span>{new Date(repayment.date).toLocaleDateString('fr-FR')}</span>\r\n              </div>\r\n              {repayment.processed_by_name && (\r\n                <div style={styles.mobileCardRow}>\r\n                  <span>Traité par:</span> \r\n                  <span>{repayment.processed_by_name}</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    ) : (\r\n      <div style={styles.tableContainer}>\r\n        <table style={styles.table}>\r\n          <thead>\r\n            <tr>\r\n              <th style={styles.th}>Prêt</th>\r\n              <th style={styles.th}>Emprunteur</th>\r\n              <th style={styles.th}>Montant</th>\r\n              <th style={styles.th}>Capital</th>\r\n              <th style={styles.th}>Intérêts</th>\r\n              <th style={styles.th}>Type</th>\r\n              <th style={styles.th}>Date</th>\r\n              <th style={styles.th}>Traité par</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {repayments.map(repayment => (\r\n              <tr key={repayment.id}>\r\n                <td style={styles.td}>#{repayment.loan_request}</td>\r\n                <td style={styles.td}>{repayment.loan_member_name}</td>\r\n                <td style={styles.td}>{repayment.amount.toLocaleString()} XAF</td>\r\n                <td style={styles.td}>{repayment.capital_amount.toLocaleString()} XAF</td>\r\n                <td style={styles.td}>{repayment.interest_amount.toLocaleString()} XAF</td>\r\n                <td style={styles.td}>\r\n                  <span style={{...styles.chip, backgroundColor: '#dcfce7', color: '#166534'}}>\r\n                    {LoanService.getPaymentTypeDisplayName(repayment.payment_type)}\r\n                  </span>\r\n                </td>\r\n                <td style={styles.td}>{new Date(repayment.date).toLocaleDateString('fr-FR')}</td>\r\n                <td style={styles.td}>{repayment.processed_by_name || '-'}</td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    )}\r\n  </div>\r\n);\r\n\r\n// --- VUES DESKTOP & MOBILE POUR LES PRÊTS ---\r\ninterface TableProps {\r\n  loans: ApiLoanRequest[];\r\n  members: ApiMember[];\r\n  hasPermission: any;\r\n  onStatusUpdate: (id: number, status: 'approved' | 'rejected') => void;\r\n  onRepayment: (loan: ApiLoanRequest) => void;\r\n  getMemberName: (id: number) => string;\r\n  getGuarantorNames: (ids: number[]) => string;\r\n  canAddRepayments: boolean;\r\n}\r\n\r\nconst DesktopLoanTable: React.FC<TableProps> = ({ \r\n  loans, \r\n  members, \r\n  hasPermission, \r\n  onStatusUpdate, \r\n  onRepayment,\r\n  getMemberName, \r\n  getGuarantorNames,\r\n  canAddRepayments\r\n}) => (\r\n  <div style={styles.tableContainer}>\r\n    <table style={styles.table}>\r\n      <thead>\r\n        <tr>\r\n          <th style={styles.th}>Membre</th>\r\n          <th style={styles.th}>Montant</th>\r\n          <th style={styles.th}>Solde</th>\r\n          <th style={styles.th}>Progression</th>\r\n          <th style={styles.th}>Statut</th>\r\n          <th style={styles.th}>Actions</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        {loans.map(loan => {\r\n          const progressPercentage = ((loan.total_repaid / loan.total_amount_with_interest) * 100).toFixed(1);\r\n          \r\n          return (\r\n            <tr key={loan.id}>\r\n              <td style={styles.td}>{loan.member_name}</td>\r\n              <td style={styles.td}>{loan.amount.toLocaleString()} XAF</td>\r\n              <td style={styles.td}>\r\n                {loan.status === 'approved' ? (\r\n                  <div>\r\n                    <div>{loan.remaining_balance.toLocaleString()} XAF</div>\r\n                    <div style={{fontSize: '12px', color: '#6b7280'}}>\r\n                      sur {loan.total_amount_with_interest.toLocaleString()} XAF\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  loan.total_amount_with_interest.toLocaleString() + ' XAF'\r\n                )}\r\n              </td>\r\n              <td style={styles.td}>\r\n                {loan.status === 'approved' && (\r\n                  <div style={{width: '100px'}}>\r\n                    <div style={{\r\n                      backgroundColor: '#e5e7eb',\r\n                      borderRadius: '4px',\r\n                      height: '8px',\r\n                      overflow: 'hidden'\r\n                    }}>\r\n                      <div style={{\r\n                        backgroundColor: loan.is_fully_repaid ? '#22c55e' : '#3b82f6',\r\n                        height: '100%',\r\n                        width: `${progressPercentage}%`,\r\n                        transition: 'width 0.3s ease'\r\n                      }} />\r\n                    </div>\r\n                    <div style={{fontSize: '12px', marginTop: '2px', textAlign: 'center'}}>\r\n                      {progressPercentage}%\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </td>\r\n              <td style={styles.td}>\r\n                <StatusChip status={LoanService.getStatusDisplayName(loan.status)} />\r\n              </td>\r\n              <td style={styles.td}>\r\n                <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>\r\n                  {loan.status === 'pending' && hasPermission('approve_loans') && (\r\n                    <>\r\n                      <button \r\n                        onClick={() => onStatusUpdate(loan.id, 'approved')} \r\n                        style={{...styles.actionButton, backgroundColor: '#22c55e'}} \r\n                        title=\"Approuver\"\r\n                      >\r\n                        <FontAwesomeIcon icon={faCheck} />\r\n                      </button>\r\n                      <button \r\n                        onClick={() => onStatusUpdate(loan.id, 'rejected')} \r\n                        style={{...styles.actionButton, backgroundColor: '#ef4444'}} \r\n                        title=\"Rejeter\"\r\n                      >\r\n                        <FontAwesomeIcon icon={faTimes} />\r\n                      </button>\r\n                    </>\r\n                  )}\r\n                  {loan.status === 'approved' && !loan.is_fully_repaid && canAddRepayments && (\r\n                    <button \r\n                      onClick={() => onRepayment(loan)} \r\n                      style={{...styles.actionButton, backgroundColor: '#3b82f6'}} \r\n                      title=\"Rembourser\"\r\n                    >\r\n                      <FontAwesomeIcon icon={faMoneyBillWave} />\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </td>\r\n            </tr>\r\n          );\r\n        })}\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n);\r\n\r\nconst MobileLoanList: React.FC<TableProps> = ({ \r\n  loans, \r\n  members, \r\n  hasPermission, \r\n  onStatusUpdate, \r\n  onRepayment,\r\n  getMemberName, \r\n  getGuarantorNames,\r\n  canAddRepayments\r\n}) => (\r\n  <div style={{display: 'flex', flexDirection: 'column', gap: '16px'}}>\r\n    {loans.map(loan => {\r\n      const progressPercentage = ((loan.total_repaid / loan.total_amount_with_interest) * 100).toFixed(1);\r\n      \r\n      return (\r\n        <div key={loan.id} style={styles.mobileCard}>\r\n          <div style={styles.mobileCardHeader}>\r\n            <span style={{fontWeight: 'bold', color: '#1f2937'}}>\r\n              {loan.member_name}\r\n            </span>\r\n            <StatusChip status={LoanService.getStatusDisplayName(loan.status)} />\r\n          </div>\r\n          <div style={styles.mobileCardBody}>\r\n            <div style={styles.mobileCardRow}>\r\n              <span>Montant initial:</span> \r\n              <strong>{loan.amount.toLocaleString()} XAF</strong>\r\n            </div>\r\n            {loan.status === 'approved' && (\r\n              <>\r\n                <div style={styles.mobileCardRow}>\r\n                  <span>Solde restant:</span> \r\n                  <strong style={{color: loan.is_fully_repaid ? '#22c55e' : '#ef4444'}}>\r\n                    {loan.remaining_balance.toLocaleString()} XAF\r\n                  </strong>\r\n                </div>\r\n                <div style={styles.mobileCardRow}>\r\n                  <span>Progression:</span> \r\n                  <span>{progressPercentage}% remboursé</span>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n          \r\n          <div style={styles.mobileCardFooter}>\r\n            {loan.status === 'pending' && hasPermission('approve_loans') && (\r\n              <>\r\n                <button \r\n                  onClick={() => onStatusUpdate(loan.id, 'approved')} \r\n                  style={{...styles.button, flex: 1, backgroundColor: '#22c55e'}}\r\n                >\r\n                  <FontAwesomeIcon icon={faCheck} style={{marginRight: '8px'}}/> \r\n                  Approuver\r\n                </button>\r\n                <button \r\n                  onClick={() => onStatusUpdate(loan.id, 'rejected')} \r\n                  style={{...styles.button, flex: 1, backgroundColor: '#ef4444'}}\r\n                >\r\n                  <FontAwesomeIcon icon={faTimes} style={{marginRight: '8px'}}/> \r\n                  Rejeter\r\n                </button>\r\n              </>\r\n            )}\r\n            {loan.status === 'approved' && !loan.is_fully_repaid && canAddRepayments && (\r\n              <button \r\n                onClick={() => onRepayment(loan)} \r\n                style={{...styles.button, flex: 1, backgroundColor: '#3b82f6'}}\r\n              >\r\n                <FontAwesomeIcon icon={faMoneyBillWave} style={{marginRight: '8px'}}/> \r\n                Rembourser\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      );\r\n    })}\r\n  </div>\r\n);\r\n\r\n// --- SOUS-COMPOSANTS & STYLES ---\r\nconst StatCard: React.FC<{ title: string; value: string | number }> = ({ title, value }) => (\r\n  <div style={{...styles.card, flex: '1 1 250px', textAlign: 'center' }}>\r\n    <h4 style={styles.statTitle}>{title}</h4>\r\n    <p style={styles.statValue}>{value}</p>\r\n  </div>\r\n);\r\n\r\nconst StatusChip: React.FC<{ status: string }> = ({ status }) => { \r\n  const statusColors: { [key: string]: { backgroundColor: string; color: string } } = {\r\n    'En attente': { backgroundColor: '#fef3c7', color: '#92400e' },\r\n    'Approuvé': { backgroundColor: '#dcfce7', color: '#166534' },\r\n    'Rejeté': { backgroundColor: '#fee2e2', color: '#991b1b' },\r\n    'Remboursé': { backgroundColor: '#e0e7ff', color: '#3730a3' }\r\n  };\r\n  \r\n  return (\r\n    <span style={{ ...styles.chip, ...statusColors[status] }}>\r\n      {status}\r\n    </span>\r\n  ); \r\n};\r\n\r\ninterface ModalInputProps extends InputHTMLAttributes<HTMLInputElement> { \r\n  label: string; \r\n}\r\nconst ModalInput: React.FC<ModalInputProps> = ({ label, ...props }) => (\r\n  <div>\r\n    <label style={styles.modalLabel}>{label}</label>\r\n    <input style={styles.modalInput} {...props} />\r\n  </div>\r\n);\r\n\r\ninterface ModalSelectProps extends SelectHTMLAttributes<HTMLSelectElement> { \r\n  label: string; \r\n  children: ReactNode; \r\n}\r\nconst ModalSelect: React.FC<ModalSelectProps> = ({ label, children, ...props }) => (\r\n  <div>\r\n    <label style={styles.modalLabel}>{label}</label>\r\n    <select style={styles.modalInput} {...props}>{children}</select>\r\n  </div>\r\n);\r\n\r\ninterface ModalTextareaProps extends TextareaHTMLAttributes<HTMLTextAreaElement> { \r\n  label: string; \r\n}\r\nconst ModalTextarea: React.FC<ModalTextareaProps> = ({ label, ...props }) => (\r\n  <div>\r\n    <label style={styles.modalLabel}>{label}</label>\r\n    <textarea style={{...styles.modalInput, height: '80px'}} {...props} />\r\n  </div>\r\n);\r\n\r\nconst styles: { [key: string]: React.CSSProperties } = {\r\n  page: { fontFamily: 'Arial, sans-serif', padding: '16px', backgroundColor: '#f3f4f6', minHeight: '100vh' },\r\n  header: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '24px', flexWrap: 'wrap', gap: '16px' },\r\n  headerTitle: { fontSize: '24px', fontWeight: 'bold', color: '#1f2937', margin: 0 },\r\n  loadingText: { fontSize: '16px', fontWeight: 'normal', color: '#6b7280' },\r\n  errorContainer: { textAlign: 'center', padding: '40px', backgroundColor: 'white', borderRadius: '12px', boxShadow: '0 4px 12px rgba(0, 0, 0, 0.08)' },\r\n  loadingContainer: { textAlign: 'center', padding: '40px' },\r\n  emptyState: { textAlign: 'center', padding: '40px', backgroundColor: 'white', borderRadius: '12px', boxShadow: '0 4px 12px rgba(0, 0, 0, 0.08)' },\r\n  statSection: { display: 'flex', gap: '16px', flexWrap: 'wrap', marginBottom: '24px' },\r\n  card: { backgroundColor: 'white', padding: '16px', borderRadius: '12px', boxShadow: '0 4px 12px rgba(0, 0, 0, 0.08)' },\r\n  statTitle: { margin: 0, color: '#4b5563', fontSize: '14px', fontWeight: '600' },\r\n  statValue: { margin: '8px 0 0 0', color: '#1e3a8a', fontSize: '22px', fontWeight: 'bold' },\r\n  \r\n  // Styles des onglets\r\n  tabSection: { display: 'flex', marginBottom: '24px', backgroundColor: 'white', borderRadius: '12px', overflow: 'hidden', boxShadow: '0 4px 12px rgba(0, 0, 0, 0.08)' },\r\n  tabButton: { flex: 1, padding: '12px 24px', border: 'none', fontSize: '14px', fontWeight: '600', cursor: 'pointer', transition: 'all 0.2s', display: 'flex', alignItems: 'center', justifyContent: 'center' },\r\n  activeTab: { backgroundColor: '#3b82f6', color: 'white' },\r\n  inactiveTab: { backgroundColor: 'white', color: '#6b7280' },\r\n  \r\n  controlsSection: { marginBottom: '24px' },\r\n  button: { padding: '10px 16px', backgroundColor: '#2563eb', color: 'white', border: 'none', borderRadius: '8px', cursor: 'pointer', fontWeight: '600', display: 'flex', alignItems: 'center', justifyContent: 'center', transition: 'background-color 0.2s', fontSize: '14px' },\r\n  permissionInfo: { backgroundColor: '#e0f2fe', padding: '12px', borderRadius: '8px', marginTop: '16px', border: '1px solid #0891b2' },\r\n  tableContainer: { backgroundColor: 'white', borderRadius: '12px', boxShadow: '0 4px 12px rgba(0, 0, 0, 0.08)', overflowX: 'auto' },\r\n  table: { width: '100%', borderCollapse: 'collapse' },\r\n  th: { padding: '12px 16px', textAlign: 'left', fontSize: '14px', color: '#4b5563', backgroundColor: '#f9fafb', borderBottom: '1px solid #e5e7eb', fontWeight: '600' },\r\n  td: { padding: '12px 16px', fontSize: '14px', color: '#374151', borderBottom: '1px solid #e5e7eb', verticalAlign: 'middle' },\r\n  chip: { padding: '4px 12px', borderRadius: '9999px', fontWeight: '600', fontSize: '12px' },\r\n  actionButton: { padding: '8px 12px', border: 'none', borderRadius: '6px', color: 'white', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '14px', fontWeight: 'bold' },\r\n  \r\n  // Styles des modals\r\n  modalOverlay: { position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, backgroundColor: 'rgba(0, 0, 0, 0.6)', display: 'flex', justifyContent: 'center', alignItems: 'center', zIndex: 1000, padding: '16px' },\r\n  modalContent: { backgroundColor: 'white', padding: '24px', borderRadius: '12px', width: '100%', maxWidth: '600px', boxShadow: '0 8px 16px rgba(0, 0, 0, 0.2)', maxHeight: '90vh', display: 'flex', flexDirection: 'column' },\r\n  modalTitle: { fontSize: '22px', fontWeight: 'bold', marginBottom: '24px', color: '#1f2937', flexShrink: 0, textAlign: 'center' },\r\n  modalForm: { flexGrow: 1, overflowY: 'auto', paddingRight: '12px', marginRight: '-12px', display: 'flex', flexDirection: 'column', gap: '16px' },\r\n  modalLabel: { display: 'block', marginBottom: '8px', fontWeight: '600', color: '#374151', fontSize: '14px' },\r\n  modalInput: { width: '100%', padding: '10px', border: '1px solid #d1d5db', borderRadius: '8px', boxSizing: 'border-box', fontSize: '16px' },\r\n  disabledInput: { width: '100%', padding: '10px', border: '1px solid #e5e7eb', backgroundColor: '#f9fafb', color: '#6b7280', borderRadius: '8px', boxSizing: 'border-box', fontSize: '16px' },\r\n  modalActions: { display: 'flex', justifyContent: 'flex-end', gap: '12px', marginTop: '24px', flexShrink: 0 },\r\n  formError: { color: '#ef4444', backgroundColor: '#fee2e2', padding: '10px', borderRadius: '8px', textAlign: 'center', marginBottom: '16px' },\r\n  \r\n  // Styles spécifiques aux remboursements\r\n  loanDetailsBox: { backgroundColor: '#f3f4f6', padding: '12px', borderRadius: '8px', fontSize: '14px', lineHeight: 1.6, borderLeft: '4px solid #3b82f6'},\r\n  loanInfoBox: { backgroundColor: '#f0f9ff', padding: '16px', borderRadius: '8px', fontSize: '14px', lineHeight: 1.6, borderLeft: '4px solid #0ea5e9' },\r\n  calculationBox: { backgroundColor: '#f0fdf4', padding: '12px', borderRadius: '8px', fontSize: '14px', lineHeight: 1.6, borderLeft: '4px solid #22c55e' },\r\n  \r\n  // Styles mobile\r\n  mobileCard: { backgroundColor: 'white', borderRadius: '12px', boxShadow: '0 4px 12px rgba(0, 0, 0, 0.08)', overflow: 'hidden'},\r\n  mobileCardHeader: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px 16px', backgroundColor: '#f9fafb', borderBottom: '1px solid #e5e7eb'},\r\n  mobileCardBody: { padding: '16px', display: 'flex', flexDirection: 'column', gap: '10px' },\r\n  mobileCardRow: { display: 'flex', justifyContent: 'space-between', fontSize: '14px' },\r\n  mobileCardFooter: { padding: '12px 16px', backgroundColor: '#f9fafb', borderTop: '1px solid #e5e7eb', display: 'flex', gap: '12px' },\r\n};\r\n\r\nexport default Loans;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,OAAO,KAAmG,OAAO,CACtJ,OAASC,OAAO,KAAQ,wBAAwB,CAChD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,eAAe,KAAQ,gCAAgC,CAChE,OAASC,MAAM,CAAEC,OAAO,CAAEC,OAAO,CAAEC,eAAe,CAAEC,SAAS,CAAEC,YAAY,KAAQ,mCAAmC,CAEtH;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBACA,KAAM,CAAAC,aAAa,CAAGA,CAAA,GAAM,CAC1B,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGpB,QAAQ,CAAC,CAACqB,MAAM,CAACC,UAAU,CAAC,CAAC,CACrDrB,SAAS,CAAC,IAAM,CACd,KAAM,CAAAsB,YAAY,CAAGA,CAAA,GAAMH,OAAO,CAAC,CAACC,MAAM,CAACC,UAAU,CAAC,CAAC,CACvDD,MAAM,CAACG,gBAAgB,CAAC,QAAQ,CAAED,YAAY,CAAC,CAC/C,MAAO,IAAMF,MAAM,CAACI,mBAAmB,CAAC,QAAQ,CAAEF,YAAY,CAAC,CACjE,CAAC,CAAE,EAAE,CAAC,CACN,MAAO,CAAEG,KAAK,CAAEP,IAAI,CAAC,CAAC,CAAE,CAAC,CAC3B,CAAC,CAED;AAoEA;AACA,KAAM,CAAAQ,iBAAiB,CAAG,GAAG,CAC7B,KAAM,CAAAC,YAAY,CAAG,8BAA8B,CAEnD;AACA,KAAM,CAAAC,WAAW,CAAG,CAClBC,gBAAgB,CAAGC,WAAmB,EAAK,CACzC,GAAIA,WAAW,EAAI,EAAE,EAAIA,WAAW,EAAI,GAAG,CAAE,MAAO,MAAK,CACzD,GAAIA,WAAW,CAAG,GAAG,EAAIA,WAAW,EAAI,GAAG,CAAE,MAAO,OAAM,CAC1D,GAAIA,WAAW,EAAI,GAAG,EAAIA,WAAW,EAAI,GAAG,CAAE,MAAO,OAAM,CAC3D,GAAIA,WAAW,EAAI,GAAG,CAAE,MAAO,OAAM,CACrC,MAAO,EAAC,CACV,CAAC,CAEDC,eAAe,CAAGC,MAAc,EAAK,CACnC,GAAIA,MAAM,CAAG,CAAC,EAAIA,MAAM,CAAG,KAAK,CAAE,MAAO,GAAE,CAC3C,GAAIA,MAAM,EAAI,KAAK,EAAIA,MAAM,CAAG,MAAM,CAAE,MAAO,EAAC,CAChD,GAAIA,MAAM,EAAI,MAAM,CAAE,MAAO,EAAC,CAC9B,MAAO,EAAC,CACV,CAAC,CAEDC,qBAAqB,CAAEA,CAACD,MAAc,CAAEE,YAAoB,GAAK,CAC/D,MAAO,CAAAF,MAAM,EAAI,CAAC,CAAGE,YAAY,CAAG,GAAG,CAAC,CAC1C,CAAC,CAEDC,oBAAoB,CAAGC,MAAc,EAAK,CACxC,KAAM,CAAAC,SAAoC,CAAG,CAC3C,SAAS,CAAE,YAAY,CACvB,UAAU,CAAE,UAAU,CACtB,UAAU,CAAE,QAAQ,CACpB,QAAQ,CAAE,WACZ,CAAC,CACD,MAAO,CAAAA,SAAS,CAACD,MAAM,CAAC,EAAIA,MAAM,CACpC,CAAC,CAEDE,yBAAyB,CAAGC,IAAY,EAAK,CAC3C,KAAM,CAAAC,OAAkC,CAAG,CACzC,SAAS,CAAE,uBAAuB,CAClC,eAAe,CAAE,qBAAqB,CACtC,MAAM,CAAE,uBACV,CAAC,CACD,MAAO,CAAAA,OAAO,CAACD,IAAI,CAAC,EAAIA,IAAI,CAC9B,CACF,CAAC,CAED;AACA,KAAM,CAAAE,KAAe,CAAGA,CAAA,GAAM,CAC5B,KAAM,CAAEC,IAAI,CAAEC,aAAc,CAAC,CAAGzC,OAAO,CAAC,CAAC,CACzC,KAAM,CAAA0C,QAAQ,CAAGzC,WAAW,CAAC,CAAC,CAE9B;AACA,KAAM,CAAC0C,KAAK,CAAEC,QAAQ,CAAC,CAAG/C,QAAQ,CAAmB,EAAE,CAAC,CACxD,KAAM,CAACgD,OAAO,CAAEC,UAAU,CAAC,CAAGjD,QAAQ,CAAc,EAAE,CAAC,CACvD,KAAM,CAACkD,OAAO,CAAEC,UAAU,CAAC,CAAGnD,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACoD,KAAK,CAAEC,QAAQ,CAAC,CAAGrD,QAAQ,CAAgB,IAAI,CAAC,CACvD,KAAM,CAACsD,eAAe,CAAEC,kBAAkB,CAAC,CAAGvD,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAACwD,YAAY,CAAEC,eAAe,CAAC,CAAGzD,QAAQ,CAAC,KAAK,CAAC,CACvD,KAAM,CAAC0D,SAAS,CAAEC,YAAY,CAAC,CAAG3D,QAAQ,CAAC,EAAE,CAAC,CAE9C;AACA,KAAM,CAAC4D,UAAU,CAAEC,aAAa,CAAC,CAAG7D,QAAQ,CAAqB,EAAE,CAAC,CACpE,KAAM,CAAC8D,oBAAoB,CAAEC,uBAAuB,CAAC,CAAG/D,QAAQ,CAAC,KAAK,CAAC,CACvE,KAAM,CAACgE,wBAAwB,CAAEC,2BAA2B,CAAC,CAAGjE,QAAQ,CAAwB,IAAI,CAAC,CACrG,KAAM,CAACkE,SAAS,CAAEC,YAAY,CAAC,CAAGnE,QAAQ,CAAyB,OAAO,CAAC,CAE3E,KAAM,CAAAoE,oBAAkC,CAAG,CACzCC,MAAM,CAAE,CAAC,CACTpC,MAAM,CAAE,IAAI,CACZqC,aAAa,CAAE,EAAE,CACjBC,UAAU,CAAE,EACd,CAAC,CAED,KAAM,CAAAC,yBAA4C,CAAG,CACnDC,YAAY,CAAE,CAAC,CACfxC,MAAM,CAAE,CAAC,CACTyC,YAAY,CAAE,SAAS,CACvBC,KAAK,CAAE,EACT,CAAC,CAED,KAAM,CAACC,cAAc,CAAEC,iBAAiB,CAAC,CAAG7E,QAAQ,CAACoE,oBAAoB,CAAC,CAC1E,KAAM,CAACU,YAAY,CAAEC,eAAe,CAAC,CAAG/E,QAAQ,CAACwE,yBAAyB,CAAC,CAC3E,KAAM,CAACQ,YAAY,CAAEC,eAAe,CAAC,CAAGjF,QAAQ,CAAS,CAAC,CAAC,CAC3D,KAAM,CAACkF,YAAY,CAAEC,eAAe,CAAC,CAAGnF,QAAQ,CAAS,CAAC,CAAC,CAE3D;AACA,KAAM,CAAAoF,cAAc,CAAGlF,OAAO,CAAC,IAAM,CACnC,MAAO,CAAA8C,OAAO,CAACqC,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACC,EAAE,GAAKX,cAAc,CAACP,MAAM,CAAC,CAC1D,CAAC,CAAE,CAACO,cAAc,CAACP,MAAM,CAAErB,OAAO,CAAC,CAAC,CAEpC,KAAM,CAAAwC,WAAW,CAAGtF,OAAO,CAAC,IAAM,CAChC,GAAI,CAACkF,cAAc,CAAE,MAAO,KAAI,CAEhC,KAAM,CAAAK,SAAS,CAAG5D,WAAW,CAACC,gBAAgB,CAACsD,cAAc,CAACM,WAAW,CAAC,CAC1E,KAAM,CAAAvD,YAAY,CAAGN,WAAW,CAACG,eAAe,CAAC4C,cAAc,CAAC3C,MAAM,CAAC,CACvE,KAAM,CAAA0D,YAAY,CAAG9D,WAAW,CAACK,qBAAqB,CAAC0C,cAAc,CAAC3C,MAAM,CAAEE,YAAY,CAAC,CAE3F,GAAI,CAAAiB,KAAK,CAAG,EAAE,CACd,GAAIwB,cAAc,CAAC3C,MAAM,CAAGwD,SAAS,CAAE,CACrCrC,KAAK,CAAG,+CAA+CqC,SAAS,CAACG,cAAc,CAAC,CAAC,OAAO,CAC1F,CAEA,MAAO,CAAEH,SAAS,CAAEtD,YAAY,CAAEwD,YAAY,CAAEvC,KAAM,CAAC,CACzD,CAAC,CAAE,CAACwB,cAAc,CAAC3C,MAAM,CAAEmD,cAAc,CAAC,CAAC,CAE3C,KAAM,CAAAS,qBAAqB,CAAG3F,OAAO,CAAC,IAAM,CAC1C,GAAI,CAAC8D,wBAAwB,CAAE,MAAO,KAAI,CAE1C,KAAM,CAAA8B,IAAI,CAAG9B,wBAAwB,CACrC,KAAM,CAAA/B,MAAM,CAAG6C,YAAY,CAAC7C,MAAM,CAElC,GAAIA,MAAM,EAAI,CAAC,CAAE,MAAO,KAAI,CAE5B,GAAI,CAAA8D,aAAa,CAAG,CAAC,CACrB,GAAI,CAAAC,cAAc,CAAG,CAAC,CACtB,GAAI,CAAA5C,KAAK,CAAG,EAAE,CAEd,GAAInB,MAAM,CAAG6D,IAAI,CAACG,iBAAiB,CAAE,CACnC7C,KAAK,CAAG,wCAAwC0C,IAAI,CAACG,iBAAiB,CAACL,cAAc,CAAC,CAAC,OAAO,CAChG,CAAC,IAAM,IAAId,YAAY,CAACJ,YAAY,GAAK,eAAe,CAAE,CACxD,GAAIzC,MAAM,CAAG6D,IAAI,CAACI,kBAAkB,CAAE,CACpC9C,KAAK,CAAG,6CAA6C0C,IAAI,CAACI,kBAAkB,CAACN,cAAc,CAAC,CAAC,OAAO,CACtG,CAAC,IAAM,CACLI,cAAc,CAAG/D,MAAM,CACvB8D,aAAa,CAAG,CAAC,CACnB,CACF,CAAC,IAAM,CACL;AACA,GAAI9D,MAAM,EAAI6D,IAAI,CAACI,kBAAkB,CAAE,CACrCF,cAAc,CAAG/D,MAAM,CACvB8D,aAAa,CAAG,CAAC,CACnB,CAAC,IAAM,CACLC,cAAc,CAAGF,IAAI,CAACI,kBAAkB,CACxCH,aAAa,CAAG9D,MAAM,CAAG6D,IAAI,CAACI,kBAAkB,CAEhD;AACA,GAAIH,aAAa,CAAG,CAAC,EAAIA,aAAa,CAAGD,IAAI,CAACK,uBAAuB,EAAIL,IAAI,CAACM,iBAAiB,CAAGN,IAAI,CAACK,uBAAuB,CAAE,CAC9H/C,KAAK,CAAG,oDAAoD0C,IAAI,CAACK,uBAAuB,CAACP,cAAc,CAAC,CAAC,+BAA+B,CAC1I,CACF,CACF,CAEA,MAAO,CAAEG,aAAa,CAAEC,cAAc,CAAE5C,KAAM,CAAC,CACjD,CAAC,CAAE,CAAC0B,YAAY,CAAC7C,MAAM,CAAE6C,YAAY,CAACJ,YAAY,CAAEV,wBAAwB,CAAC,CAAC,CAE9E,KAAM,CAAAqC,SAAS,CAAGnG,OAAO,CAAC,KAAO,CAC/BoG,YAAY,CAAExD,KAAK,CAACyD,MAAM,CAACC,CAAC,EAAIA,CAAC,CAACnE,MAAM,GAAK,SAAS,CAAC,CAACoE,MAAM,CAC9DC,gBAAgB,CAAE5D,KAAK,CAACyD,MAAM,CAACC,CAAC,EAAIA,CAAC,CAACnE,MAAM,GAAK,UAAU,CAAC,CAACsE,MAAM,CAAC,CAACC,GAAG,CAAEJ,CAAC,GAAKI,GAAG,CAAGJ,CAAC,CAACP,iBAAiB,CAAE,CAAC,CAAC,CAC7GY,YAAY,CAAE/D,KAAK,CAAC6D,MAAM,CAAC,CAACC,GAAG,CAAEJ,CAAC,GAAKI,GAAG,CAAGJ,CAAC,CAACM,YAAY,CAAE,CAAC,CAChE,CAAC,CAAC,CAAE,CAAChE,KAAK,CAAC,CAAC,CAEZ;AACA,KAAM,CAAAiE,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CACF5D,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,IAAI,CAAC,CAEd,KAAM,CAAA2D,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,GAAGrF,YAAY,iBAAiB,CAAE,CAC7DsF,OAAO,CAAE,CACP,eAAe,CAAE,UAAUvE,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEwE,KAAK,EAAE,CACxC,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,CAEF,GAAI,CAACH,QAAQ,CAACI,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAC,KAAK,CAAC,gBAAgBL,QAAQ,CAAC3E,MAAM,EAAE,CAAC,CACpD,CAEA,KAAM,CAAAiF,IAAI,CAAG,KAAM,CAAAN,QAAQ,CAACO,IAAI,CAAC,CAAC,CAClCxE,QAAQ,CAACuE,IAAI,CAAC,CAChB,CAAE,MAAOE,GAAG,CAAE,CACZnE,QAAQ,CAACmE,GAAG,WAAY,CAAAH,KAAK,CAAGG,GAAG,CAACC,OAAO,CAAG,qCAAqC,CAAC,CACpFC,OAAO,CAACtE,KAAK,CAAC,sCAAsC,CAAEoE,GAAG,CAAC,CAC5D,CAAC,OAAS,CACRrE,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAwE,eAAe,CAAG,KAAAA,CAAA,GAAY,CAClC,GAAI,CACF,KAAM,CAAAX,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,GAAGrF,YAAY,mBAAmB,CAAE,CAC/DsF,OAAO,CAAE,CACP,eAAe,CAAE,UAAUvE,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEwE,KAAK,EAAE,CACxC,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,CAEF,GAAI,CAACH,QAAQ,CAACI,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAC,KAAK,CAAC,gBAAgBL,QAAQ,CAAC3E,MAAM,EAAE,CAAC,CACpD,CAEA,KAAM,CAAAiF,IAAI,CAAG,KAAM,CAAAN,QAAQ,CAACO,IAAI,CAAC,CAAC,CAClC1D,aAAa,CAACyD,IAAI,CAAC,CACrB,CAAE,MAAOE,GAAG,CAAE,CACZE,OAAO,CAACtE,KAAK,CAAC,+CAA+C,CAAEoE,GAAG,CAAC,CACrE,CACF,CAAC,CAED,KAAM,CAAAI,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CACF,KAAM,CAAAZ,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,GAAGrF,YAAY,WAAW,CAAE,CACvDsF,OAAO,CAAE,CACP,eAAe,CAAE,UAAUvE,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEwE,KAAK,EAAE,CACxC,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,CAEF,GAAI,CAACH,QAAQ,CAACI,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAC,KAAK,CAAC,gBAAgBL,QAAQ,CAAC3E,MAAM,EAAE,CAAC,CACpD,CAEA,KAAM,CAAAiF,IAAI,CAAG,KAAM,CAAAN,QAAQ,CAACO,IAAI,CAAC,CAAC,CAClCtE,UAAU,CAACqE,IAAI,CAAC,CAClB,CAAE,MAAOE,GAAG,CAAE,CACZE,OAAO,CAACtE,KAAK,CAAC,wCAAwC,CAAEoE,GAAG,CAAC,CAC9D,CACF,CAAC,CAED;AACAvH,SAAS,CAAC,IAAM,CACd,GAAI0C,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAEwE,KAAK,CAAE,CACfJ,UAAU,CAAC,CAAC,CACZY,eAAe,CAAC,CAAC,CACjBC,YAAY,CAAC,CAAC,CAChB,CACF,CAAC,CAAE,CAACjF,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEwE,KAAK,CAAC,CAAC,CAEjB,KAAM,CAAEzF,KAAM,CAAC,CAAGR,aAAa,CAAC,CAAC,CACjC,KAAM,CAAA2G,QAAQ,CAAGnG,KAAK,CAAGC,iBAAiB,CAE1C;AACA,GAAI,CAACiB,aAAa,CAAC,YAAY,CAAC,CAAE,CAChC,mBACE/B,IAAA,QAAKiH,KAAK,CAAEC,MAAM,CAACC,IAAK,CAAAC,QAAA,cACtBlH,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAACG,cAAe,CAAAD,QAAA,eAChCpH,IAAA,OAAAoH,QAAA,CAAI,oBAAY,CAAI,CAAC,cACrBpH,IAAA,MAAAoH,QAAA,CAAG,0DAAqD,CAAG,CAAC,EACzD,CAAC,CACH,CAAC,CAEV,CAEA;AACA,KAAM,CAAAE,mBAAmB,CAAGA,CAAA,GAAM,CAChC,GAAI,CAACvF,aAAa,CAAC,mBAAmB,CAAC,CAAE,CACvCwF,KAAK,CAAC,6DAA6D,CAAC,CACpE,OACF,CAEA,KAAM,CAAAC,aAAa,CAAGrF,OAAO,CAACqC,IAAI,CAACC,CAAC,EAAIA,CAAC,CAAC3C,IAAI,CAAC4C,EAAE,GAAK+C,QAAQ,CAAC,CAAA3F,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAE4C,EAAE,GAAI,GAAG,CAAC,CAAC,CAChFV,iBAAiB,CAAC,CAChB,GAAGT,oBAAoB,CACvBC,MAAM,CAAE,CAAAgE,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAE9C,EAAE,GAAI,CAC/B,CAAC,CAAC,CACFN,eAAe,CAAC,CAAC,CAAC,CAClBE,eAAe,CAAC,CAAC,CAAC,CAClBxB,YAAY,CAAC,EAAE,CAAC,CAChBJ,kBAAkB,CAAC,IAAI,CAAC,CAC1B,CAAC,CAED,KAAM,CAAAgF,kBAAkB,CAAG,KAAAA,CAAOhD,EAAU,CAAElD,MAA+B,GAAK,CAChF,GAAI,CAACO,aAAa,CAAC,eAAe,CAAC,CAAE,CACnCwF,KAAK,CAAC,sDAAsD,CAAC,CAC7D,OACF,CAEA,GAAI,CACF,KAAM,CAAApB,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,GAAGrF,YAAY,kBAAkB2D,EAAE,GAAG,CAAE,CACnEiD,MAAM,CAAE,OAAO,CACftB,OAAO,CAAE,CACP,eAAe,CAAE,UAAUvE,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEwE,KAAK,EAAE,CACxC,cAAc,CAAE,kBAClB,CAAC,CACDsB,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEtG,MAAO,CAAC,CACjC,CAAC,CAAC,CAEF,GAAI,CAAC2E,QAAQ,CAACI,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAC,KAAK,CAAC,yCAAyC,CAAC,CAC5D,CAEA,KAAM,CAAAN,UAAU,CAAC,CAAC,CAClBqB,KAAK,CAAC,QAAQ/F,MAAM,GAAK,UAAU,CAAG,UAAU,CAAG,QAAQ,cAAc,CAAC,CAE5E,CAAE,MAAOmF,GAAG,CAAE,CACZE,OAAO,CAACtE,KAAK,CAAC,gCAAgC,CAAEoE,GAAG,CAAC,CACpDY,KAAK,CAAC,yCAAyC,CAAC,CAClD,CACF,CAAC,CAED,KAAM,CAAAQ,qBAAqB,CAAG,KAAAA,CAAA,GAAY,CACxC,GAAI,CAACxD,cAAc,EAAI,CAACI,WAAW,EAAI,CAACZ,cAAc,CAACN,aAAa,EAAI,CAACU,YAAY,EAAI,CAACE,YAAY,CAAE,CACtGvB,YAAY,CAAC,mCAAmC,CAAC,CACjD,OACF,CAEA,GAAI6B,WAAW,CAACpC,KAAK,CAAE,CACrBO,YAAY,CAAC6B,WAAW,CAACpC,KAAK,CAAC,CAC/B,OACF,CAEA,GAAI4B,YAAY,GAAKE,YAAY,EAAIF,YAAY,GAAKI,cAAc,CAACG,EAAE,EAAIL,YAAY,GAAKE,cAAc,CAACG,EAAE,CAAE,CAC7G5B,YAAY,CAAC,wEAAwE,CAAC,CACtF,OACF,CAEAF,eAAe,CAAC,IAAI,CAAC,CACrBE,YAAY,CAAC,EAAE,CAAC,CAEhB,GAAI,CACF,KAAM,CAAAkF,QAAQ,CAAG,CACfxE,MAAM,CAAEO,cAAc,CAACP,MAAM,CAC7BpC,MAAM,CAAE2C,cAAc,CAAC3C,MAAM,CAC7BqC,aAAa,CAAEM,cAAc,CAACN,aAAa,CAC3CC,UAAU,CAAE,CAACS,YAAY,CAAEE,YAAY,CAAC,CACxC4D,aAAa,CAAEtD,WAAW,CAACrD,YAC7B,CAAC,CAED,KAAM,CAAA6E,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,GAAGrF,YAAY,iBAAiB,CAAE,CAC7D4G,MAAM,CAAE,MAAM,CACdtB,OAAO,CAAE,CACP,eAAe,CAAE,UAAUvE,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEwE,KAAK,EAAE,CACxC,cAAc,CAAE,kBAClB,CAAC,CACDsB,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACE,QAAQ,CAC/B,CAAC,CAAC,CAEF,GAAI,CAAC7B,QAAQ,CAACI,EAAE,CAAE,CAChB,KAAM,CAAA2B,SAAS,CAAG,KAAM,CAAA/B,QAAQ,CAACO,IAAI,CAAC,CAAC,CACvC,KAAM,IAAI,CAAAF,KAAK,CAAC0B,SAAS,CAAC3F,KAAK,EAAI,0CAA0C,CAAC,CAChF,CAEA,KAAM,CAAA2D,UAAU,CAAC,CAAC,CAClBxD,kBAAkB,CAAC,KAAK,CAAC,CACzB6E,KAAK,CAAC,uCAAuC,CAAC,CAEhD,CAAE,MAAOZ,GAAG,CAAE,CACZ7D,YAAY,CAAC6D,GAAG,WAAY,CAAAH,KAAK,CAAGG,GAAG,CAACC,OAAO,CAAG,4BAA4B,CAAC,CAC/EC,OAAO,CAACtE,KAAK,CAAC,6BAA6B,CAAEoE,GAAG,CAAC,CACnD,CAAC,OAAS,CACR/D,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED;AACA,KAAM,CAAAuF,wBAAwB,CAAIlD,IAAoB,EAAK,CACzD,GAAI,CAAClD,aAAa,CAAC,gBAAgB,CAAC,EAAI,CAACA,aAAa,CAAC,cAAc,CAAC,CAAE,CACtEwF,KAAK,CAAC,+DAA+D,CAAC,CACtE,OACF,CAEA,GAAItC,IAAI,CAACzD,MAAM,GAAK,UAAU,CAAE,CAC9B+F,KAAK,CAAC,oEAAoE,CAAC,CAC3E,OACF,CAEAnE,2BAA2B,CAAC6B,IAAI,CAAC,CACjCf,eAAe,CAAC,CACd,GAAGP,yBAAyB,CAC5BC,YAAY,CAAEqB,IAAI,CAACP,EAAE,CACrBtD,MAAM,CAAE6D,IAAI,CAACK,uBACf,CAAC,CAAC,CACFxC,YAAY,CAAC,EAAE,CAAC,CAChBI,uBAAuB,CAAC,IAAI,CAAC,CAC/B,CAAC,CAED,KAAM,CAAAkF,mBAAmB,CAAG,KAAAA,CAAA,GAAY,CACtC,GAAI,CAACjF,wBAAwB,EAAI,CAAC6B,qBAAqB,EAAIA,qBAAqB,CAACzC,KAAK,CAAE,CACtFO,YAAY,CAAC,CAAAkC,qBAAqB,SAArBA,qBAAqB,iBAArBA,qBAAqB,CAAEzC,KAAK,GAAI,wCAAwC,CAAC,CACtF,OACF,CAEA,GAAI0B,YAAY,CAAC7C,MAAM,EAAI,CAAC,CAAE,CAC5B0B,YAAY,CAAC,+BAA+B,CAAC,CAC7C,OACF,CAEAF,eAAe,CAAC,IAAI,CAAC,CACrBE,YAAY,CAAC,EAAE,CAAC,CAEhB,GAAI,CACF,KAAM,CAAAuF,aAAa,CAAG,CACpBzE,YAAY,CAAEK,YAAY,CAACL,YAAY,CACvCxC,MAAM,CAAE6C,YAAY,CAAC7C,MAAM,CAC3ByC,YAAY,CAAEI,YAAY,CAACJ,YAAY,CACvCC,KAAK,CAAEG,YAAY,CAACH,KAAK,CACzBwE,cAAc,CAAEtD,qBAAqB,CAACE,aAAa,CACnDqD,eAAe,CAAEvD,qBAAqB,CAACG,cACzC,CAAC,CAED,KAAM,CAAAgB,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,GAAGrF,YAAY,mBAAmB,CAAE,CAC/D4G,MAAM,CAAE,MAAM,CACdtB,OAAO,CAAE,CACP,eAAe,CAAE,UAAUvE,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEwE,KAAK,EAAE,CACxC,cAAc,CAAE,kBAClB,CAAC,CACDsB,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACO,aAAa,CACpC,CAAC,CAAC,CAEF,GAAI,CAAClC,QAAQ,CAACI,EAAE,CAAE,CAChB,KAAM,CAAA2B,SAAS,CAAG,KAAM,CAAA/B,QAAQ,CAACO,IAAI,CAAC,CAAC,CACvC,KAAM,IAAI,CAAAF,KAAK,CAAC0B,SAAS,CAAC3F,KAAK,EAAI,6CAA6C,CAAC,CACnF,CAEA,KAAM,CAAA2D,UAAU,CAAC,CAAC,CAClB,KAAM,CAAAY,eAAe,CAAC,CAAC,CACvB5D,uBAAuB,CAAC,KAAK,CAAC,CAC9BqE,KAAK,CAAC,sCAAsC,CAAC,CAE/C,CAAE,MAAOZ,GAAG,CAAE,CACZ7D,YAAY,CAAC6D,GAAG,WAAY,CAAAH,KAAK,CAAGG,GAAG,CAACC,OAAO,CAAG,8BAA8B,CAAC,CACjFC,OAAO,CAACtE,KAAK,CAAC,+BAA+B,CAAEoE,GAAG,CAAC,CACrD,CAAC,OAAS,CACR/D,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAA4F,aAAa,CAAIC,QAAgB,EAAK,CAC1C,KAAM,CAAAjF,MAAM,CAAGrB,OAAO,CAACqC,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACC,EAAE,GAAK+D,QAAQ,CAAC,CACnD,MAAO,CAAAjF,MAAM,CAAG,GAAGA,MAAM,CAAC1B,IAAI,CAAC4G,UAAU,IAAIlF,MAAM,CAAC1B,IAAI,CAAC6G,SAAS,EAAE,CAAG,gBAAgB,CACzF,CAAC,CAED,KAAM,CAAAC,iBAAiB,CAAIC,YAAsB,EAAK,CACpD,MAAO,CAAAA,YAAY,CAACC,GAAG,CAACpE,EAAE,EAAI8D,aAAa,CAAC9D,EAAE,CAAC,CAAC,CAACqE,IAAI,CAAC,IAAI,CAAC,CAC7D,CAAC,CAED;AACA,KAAM,CAAAC,YAAY,CAAGjH,aAAa,CAAC,cAAc,CAAC,EAAIA,aAAa,CAAC,eAAe,CAAC,CACpF,KAAM,CAAAkH,WAAW,CAAGlH,aAAa,CAAC,mBAAmB,CAAC,CACtD,KAAM,CAAAmH,eAAe,CAAGnH,aAAa,CAAC,eAAe,CAAC,CACtD,KAAM,CAAAoH,gBAAgB,CAAGpH,aAAa,CAAC,gBAAgB,CAAC,EAAIA,aAAa,CAAC,cAAc,CAAC,CAEzF;AACA,GAAIQ,KAAK,EAAI,CAACF,OAAO,CAAE,CACrB,mBACErC,IAAA,QAAKiH,KAAK,CAAEC,MAAM,CAACC,IAAK,CAAAC,QAAA,cACtBlH,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAACG,cAAe,CAAAD,QAAA,eAChCpH,IAAA,OAAAoH,QAAA,CAAI,sBAAoB,CAAI,CAAC,cAC7BpH,IAAA,MAAAoH,QAAA,CAAI7E,KAAK,CAAI,CAAC,cACdvC,IAAA,WAAQoJ,OAAO,CAAElD,UAAW,CAACe,KAAK,CAAEC,MAAM,CAACmC,MAAO,CAAAjC,QAAA,CAAC,cAEnD,CAAQ,CAAC,EACN,CAAC,CACH,CAAC,CAEV,CAEA;AACA,mBACElH,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAACC,IAAK,CAAAC,QAAA,eACtBlH,KAAA,WAAQ+G,KAAK,CAAEC,MAAM,CAACoC,MAAO,CAAAlC,QAAA,eAC3BlH,KAAA,OAAI+G,KAAK,CAAEC,MAAM,CAACqC,WAAY,CAAAnC,QAAA,EAAC,uCAE7B,CAAC/E,OAAO,eAAIrC,IAAA,SAAMiH,KAAK,CAAEC,MAAM,CAACsC,WAAY,CAAApC,QAAA,CAAC,kBAAgB,CAAM,CAAC,EAClE,CAAC,cACLpH,IAAA,WAAQoJ,OAAO,CAAEA,CAAA,GAAMpH,QAAQ,CAAC,GAAG,CAAE,CAACiF,KAAK,CAAE,CAAC,GAAGC,MAAM,CAACmC,MAAM,CAAEI,eAAe,CAAE,SAAS,CAAE,CAAArC,QAAA,CAAC,eAE7F,CAAQ,CAAC,EACH,CAAC,CAER4B,YAAY,eACX9I,KAAA,YAAS+G,KAAK,CAAEC,MAAM,CAACwC,WAAY,CAAAtC,QAAA,eACjCpH,IAAA,CAAC2J,QAAQ,EAACC,KAAK,CAAC,2BAAwB,CAACC,KAAK,CAAE,GAAGrE,SAAS,CAACK,gBAAgB,CAACd,cAAc,CAAC,CAAC,MAAO,CAAE,CAAC,cACxG/E,IAAA,CAAC2J,QAAQ,EAACC,KAAK,CAAC,qBAAqB,CAACC,KAAK,CAAErE,SAAS,CAACC,YAAa,CAAE,CAAC,cACvEzF,IAAA,CAAC2J,QAAQ,EAACC,KAAK,CAAC,oBAAiB,CAACC,KAAK,CAAE,GAAGrE,SAAS,CAACQ,YAAY,CAACjB,cAAc,CAAC,CAAC,MAAO,CAAE,CAAC,EACtF,CACV,cAGD7E,KAAA,YAAS+G,KAAK,CAAEC,MAAM,CAAC4C,UAAW,CAAA1C,QAAA,eAChClH,KAAA,WACEkJ,OAAO,CAAEA,CAAA,GAAM9F,YAAY,CAAC,OAAO,CAAE,CACrC2D,KAAK,CAAE,CACL,GAAGC,MAAM,CAAC6C,SAAS,CACnB,IAAI1G,SAAS,GAAK,OAAO,CAAG6D,MAAM,CAAC7D,SAAS,CAAG6D,MAAM,CAAC8C,WAAW,CACnE,CAAE,CAAA5C,QAAA,eAEFpH,IAAA,CAACR,eAAe,EAACyK,IAAI,CAAErK,eAAgB,CAACqH,KAAK,CAAE,CAAEiD,WAAW,CAAE,KAAM,CAAE,CAAE,CAAC,WAE3E,EAAQ,CAAC,cACThK,KAAA,WACEkJ,OAAO,CAAEA,CAAA,GAAM9F,YAAY,CAAC,YAAY,CAAE,CAC1C2D,KAAK,CAAE,CACL,GAAGC,MAAM,CAAC6C,SAAS,CACnB,IAAI1G,SAAS,GAAK,YAAY,CAAG6D,MAAM,CAAC7D,SAAS,CAAG6D,MAAM,CAAC8C,WAAW,CACxE,CAAE,CAAA5C,QAAA,eAEFpH,IAAA,CAACR,eAAe,EAACyK,IAAI,CAAEpK,SAAU,CAACoH,KAAK,CAAE,CAAEiD,WAAW,CAAE,KAAM,CAAE,CAAE,CAAC,iBAErE,EAAQ,CAAC,EACF,CAAC,CAGT7G,SAAS,GAAK,OAAO,cACpBnD,KAAA,CAAAE,SAAA,EAAAgH,QAAA,eACEpH,IAAA,YAASiH,KAAK,CAAEC,MAAM,CAACiD,eAAgB,CAAA/C,QAAA,CACpC6B,WAAW,eACV/I,KAAA,WAAQkJ,OAAO,CAAE9B,mBAAoB,CAACL,KAAK,CAAEC,MAAM,CAACmC,MAAO,CAAAjC,QAAA,eACzDpH,IAAA,CAACR,eAAe,EAACyK,IAAI,CAAExK,MAAO,CAACwH,KAAK,CAAE,CAAEiD,WAAW,CAAE,KAAM,CAAE,CAAE,CAAC,+BAElE,EAAQ,CACT,CACM,CAAC,CAET7H,OAAO,cACNrC,IAAA,QAAKiH,KAAK,CAAEC,MAAM,CAACkD,gBAAiB,CAAAhD,QAAA,cAClCpH,IAAA,MAAAoH,QAAA,CAAG,4BAAuB,CAAG,CAAC,CAC3B,CAAC,CACJnF,KAAK,CAAC2D,MAAM,GAAK,CAAC,cACpB1F,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAACmD,UAAW,CAAAjD,QAAA,eAC5BpH,IAAA,MAAAoH,QAAA,CAAG,uCAA+B,CAAG,CAAC,CACrC6B,WAAW,eAAIjJ,IAAA,MAAAoH,QAAA,CAAG,iDAA4C,CAAG,CAAC,EAChE,CAAC,CAENJ,QAAQ,cACNhH,IAAA,CAACsK,cAAc,EACbrI,KAAK,CAAEA,KAAM,CACbE,OAAO,CAAEA,OAAQ,CACjBJ,aAAa,CAAEA,aAAc,CAC7BwI,cAAc,CAAE7C,kBAAmB,CACnC8C,WAAW,CAAErC,wBAAyB,CACtCK,aAAa,CAAEA,aAAc,CAC7BI,iBAAiB,CAAEA,iBAAkB,CACrCO,gBAAgB,CAAEA,gBAAiB,CACpC,CAAC,cAEFnJ,IAAA,CAACyK,gBAAgB,EACfxI,KAAK,CAAEA,KAAM,CACbE,OAAO,CAAEA,OAAQ,CACjBJ,aAAa,CAAEA,aAAc,CAC7BwI,cAAc,CAAE7C,kBAAmB,CACnC8C,WAAW,CAAErC,wBAAyB,CACtCK,aAAa,CAAEA,aAAc,CAC7BI,iBAAiB,CAAEA,iBAAkB,CACrCO,gBAAgB,CAAEA,gBAAiB,CACpC,CAEJ,EACD,CAAC,cAEHnJ,IAAA,CAAC0K,gBAAgB,EACf3H,UAAU,CAAEA,UAAW,CACvBV,OAAO,CAAEA,OAAQ,CACjB2E,QAAQ,CAAEA,QAAS,CACpB,CACF,CAGA,CAACiC,WAAW,EAAI,CAACE,gBAAgB,eAChCnJ,IAAA,QAAKiH,KAAK,CAAEC,MAAM,CAACyD,cAAe,CAAAvD,QAAA,cAChClH,KAAA,MAAAkH,QAAA,eACEpH,IAAA,WAAAoH,QAAA,CAAQ,eAAa,CAAQ,CAAC,2IAEhC,EAAG,CAAC,CACD,CACN,CAGA3E,eAAe,eACdzC,IAAA,QAAKiH,KAAK,CAAEC,MAAM,CAAC0D,YAAa,CAAAxD,QAAA,cAC9BlH,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC2D,YAAa,CAAAzD,QAAA,eAC9BpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAAC4D,UAAW,CAAA1D,QAAA,CAAC,6BAAwB,CAAI,CAAC,CAC1DvE,SAAS,eAAI7C,IAAA,MAAGiH,KAAK,CAAEC,MAAM,CAACrE,SAAU,CAAAuE,QAAA,CAAEvE,SAAS,CAAI,CAAC,cAEzD3C,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC6D,SAAU,CAAA3D,QAAA,EAC1BrF,aAAa,CAAC,wBAAwB,CAAC,cACtC7B,KAAA,CAAC8K,WAAW,EACVC,KAAK,CAAC,kBAAkB,CACxBpB,KAAK,CAAE9F,cAAc,CAACP,MAAO,CAC7B0H,QAAQ,CAAGC,CAAiC,EAAKnH,iBAAiB,CAAC,CACjE,GAAGD,cAAc,CACjBP,MAAM,CAAEiE,QAAQ,CAAC0D,CAAC,CAACC,MAAM,CAACvB,KAAK,CACjC,CAAC,CAAE,CACHwB,QAAQ,CAAE1I,YAAa,CAAAyE,QAAA,eAEvBpH,IAAA,WAAQ6J,KAAK,CAAE,CAAE,CAACwB,QAAQ,MAAAjE,QAAA,CAAC,8BAAyB,CAAQ,CAAC,CAC5DjF,OAAO,CAAC2G,GAAG,CAACrE,CAAC,eACZvE,KAAA,WAAmB2J,KAAK,CAAEpF,CAAC,CAACC,EAAG,CAAA0C,QAAA,EAC5B3C,CAAC,CAAC3C,IAAI,CAAC4G,UAAU,CAAC,GAAC,CAACjE,CAAC,CAAC3C,IAAI,CAAC6G,SAAS,CAAC,IAAE,CAAClE,CAAC,CAACI,WAAW,CAAC,aACzD,GAFaJ,CAAC,CAACC,EAEP,CACT,CAAC,EACS,CAAC,cAEdxE,KAAA,QAAAkH,QAAA,eACEpH,IAAA,UAAOiH,KAAK,CAAEC,MAAM,CAACoE,UAAW,CAAAlE,QAAA,CAAC,kBAAgB,CAAO,CAAC,cACzDpH,IAAA,QAAKiH,KAAK,CAAEC,MAAM,CAACqE,aAAc,CAAAnE,QAAA,CAC9B7C,cAAc,CAAG,GAAGA,cAAc,CAACzC,IAAI,CAAC4G,UAAU,IAAInE,cAAc,CAACzC,IAAI,CAAC6G,SAAS,EAAE,CAAG,eAAe,CACrG,CAAC,EACH,CACN,CAEApE,cAAc,eACbrE,KAAA,CAAAE,SAAA,EAAAgH,QAAA,eACEpH,IAAA,CAACwL,UAAU,EACTP,KAAK,CAAC,2BAAwB,CAC9BtJ,IAAI,CAAC,QAAQ,CACb8J,IAAI,CAAC,MAAM,CACX5B,KAAK,CAAE9F,cAAc,CAAC3C,MAAO,CAC7B8J,QAAQ,CAAGC,CAAgC,EAAKnH,iBAAiB,CAAC,CAChE,GAAGD,cAAc,CACjB3C,MAAM,CAAEsK,UAAU,CAACP,CAAC,CAACC,MAAM,CAACvB,KAAK,CAAC,EAAI,CACxC,CAAC,CAAE,CACHwB,QAAQ,CAAE1I,YAAa,CACxB,CAAC,CAEDgC,WAAW,eACVzE,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAACyE,cAAe,CAAAvE,QAAA,eAChClH,KAAA,MAAAkH,QAAA,EAAG,sBAAiB,cAAAlH,KAAA,WAAAkH,QAAA,EAASzC,WAAW,CAACC,SAAS,CAACG,cAAc,CAAC,CAAC,CAAC,MAAI,EAAQ,CAAC,EAAG,CAAC,cACrF7E,KAAA,MAAAkH,QAAA,EAAG,wBAAgB,cAAAlH,KAAA,WAAAkH,QAAA,EAASzC,WAAW,CAACrD,YAAY,CAAC,GAAC,EAAQ,CAAC,EAAG,CAAC,cACnEpB,KAAA,MAAAkH,QAAA,EAAG,yBAAoB,cAAAlH,KAAA,WAAAkH,QAAA,EAASzC,WAAW,CAACG,YAAY,CAACC,cAAc,CAAC,CAAC,CAAC,MAAI,EAAQ,CAAC,EAAG,CAAC,CAC1FJ,WAAW,CAACpC,KAAK,eAAIvC,IAAA,MAAGiH,KAAK,CAAE,CAAC2E,KAAK,CAAE,SAAS,CAAE,CAAAxE,QAAA,CAAEzC,WAAW,CAACpC,KAAK,CAAI,CAAC,EACxE,CACN,cAEDvC,IAAA,CAAC6L,aAAa,EACZZ,KAAK,CAAC,4CAAsC,CAC5CpB,KAAK,CAAE9F,cAAc,CAACN,aAAc,CACpCyH,QAAQ,CAAGC,CAAmC,EAAKnH,iBAAiB,CAAC,CACnE,GAAGD,cAAc,CACjBN,aAAa,CAAE0H,CAAC,CAACC,MAAM,CAACvB,KAC1B,CAAC,CAAE,CACHiC,WAAW,CAAC,6DAAoD,CAChET,QAAQ,CAAE1I,YAAa,CACxB,CAAC,cAEFzC,KAAA,CAAC8K,WAAW,EACVC,KAAK,CAAC,sBAAsB,CAC5BpB,KAAK,CAAE1F,YAAa,CACpB+G,QAAQ,CAAGC,CAAiC,EAAK/G,eAAe,CAACqD,QAAQ,CAAC0D,CAAC,CAACC,MAAM,CAACvB,KAAK,CAAC,CAAE,CAC3FwB,QAAQ,CAAE1I,YAAa,CAAAyE,QAAA,eAEvBpH,IAAA,WAAQ6J,KAAK,CAAE,CAAE,CAACwB,QAAQ,MAAAjE,QAAA,CAAC,oBAAe,CAAQ,CAAC,CAClDjF,OAAO,CAACuD,MAAM,CAACjB,CAAC,EAAIA,CAAC,CAACC,EAAE,GAAKX,cAAc,CAACP,MAAM,CAAC,CAACsF,GAAG,CAACrE,CAAC,eACxDvE,KAAA,WAAmB2J,KAAK,CAAEpF,CAAC,CAACC,EAAG,CAAA0C,QAAA,EAC5B3C,CAAC,CAAC3C,IAAI,CAAC4G,UAAU,CAAC,GAAC,CAACjE,CAAC,CAAC3C,IAAI,CAAC6G,SAAS,GAD1BlE,CAAC,CAACC,EAEP,CACT,CAAC,EACS,CAAC,cAEdxE,KAAA,CAAC8K,WAAW,EACVC,KAAK,CAAC,sBAAsB,CAC5BpB,KAAK,CAAExF,YAAa,CACpB6G,QAAQ,CAAGC,CAAiC,EAAK7G,eAAe,CAACmD,QAAQ,CAAC0D,CAAC,CAACC,MAAM,CAACvB,KAAK,CAAC,CAAE,CAC3FwB,QAAQ,CAAE1I,YAAa,CAAAyE,QAAA,eAEvBpH,IAAA,WAAQ6J,KAAK,CAAE,CAAE,CAACwB,QAAQ,MAAAjE,QAAA,CAAC,oBAAe,CAAQ,CAAC,CAClDjF,OAAO,CAACuD,MAAM,CAACjB,CAAC,EAAIA,CAAC,CAACC,EAAE,GAAKX,cAAc,CAACP,MAAM,CAAC,CAACsF,GAAG,CAACrE,CAAC,eACxDvE,KAAA,WAAmB2J,KAAK,CAAEpF,CAAC,CAACC,EAAG,CAAA0C,QAAA,EAC5B3C,CAAC,CAAC3C,IAAI,CAAC4G,UAAU,CAAC,GAAC,CAACjE,CAAC,CAAC3C,IAAI,CAAC6G,SAAS,GAD1BlE,CAAC,CAACC,EAEP,CACT,CAAC,EACS,CAAC,EACd,CACH,EACE,CAAC,cAENxE,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC6E,YAAa,CAAA3E,QAAA,eAC9BpH,IAAA,WACEoJ,OAAO,CAAEA,CAAA,GAAM1G,kBAAkB,CAAC,KAAK,CAAE,CACzCuE,KAAK,CAAE,CAAC,GAAGC,MAAM,CAACmC,MAAM,CAAEI,eAAe,CAAE,SAAS,CAAE,CACtD4B,QAAQ,CAAE1I,YAAa,CAAAyE,QAAA,CACxB,SAED,CAAQ,CAAC,cACTpH,IAAA,WACEoJ,OAAO,CAAErB,qBAAsB,CAC/Bd,KAAK,CAAEC,MAAM,CAACmC,MAAO,CACrBgC,QAAQ,CAAE1I,YAAa,CAAAyE,QAAA,CAEtBzE,YAAY,CAAG,eAAe,CAAG,sBAAsB,CAClD,CAAC,EACN,CAAC,EACH,CAAC,CACH,CACN,CAGAM,oBAAoB,EAAIE,wBAAwB,eAC/CnD,IAAA,QAAKiH,KAAK,CAAEC,MAAM,CAAC0D,YAAa,CAAAxD,QAAA,cAC9BlH,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC2D,YAAa,CAAAzD,QAAA,eAC9BpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAAC4D,UAAW,CAAA1D,QAAA,CAAC,4BAA0B,CAAI,CAAC,CAC5DvE,SAAS,eAAI7C,IAAA,MAAGiH,KAAK,CAAEC,MAAM,CAACrE,SAAU,CAAAuE,QAAA,CAAEvE,SAAS,CAAI,CAAC,cAEzD3C,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC6D,SAAU,CAAA3D,QAAA,eAC3BlH,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC8E,WAAY,CAAA5E,QAAA,eAC7BlH,KAAA,OAAAkH,QAAA,EAAI,2BAAsB,CAACjE,wBAAwB,CAACuB,EAAE,EAAK,CAAC,cAC5DxE,KAAA,MAAAkH,QAAA,eAAGpH,IAAA,WAAAoH,QAAA,CAAQ,cAAY,CAAQ,CAAC,IAAC,CAACjE,wBAAwB,CAAC8I,WAAW,EAAI,CAAC,cAC3E/L,KAAA,MAAAkH,QAAA,eAAGpH,IAAA,WAAAoH,QAAA,CAAQ,mBAAiB,CAAQ,CAAC,IAAC,CAACjE,wBAAwB,CAAC/B,MAAM,CAAC2D,cAAc,CAAC,CAAC,CAAC,MAAI,EAAG,CAAC,cAChG7E,KAAA,MAAAkH,QAAA,eAAGpH,IAAA,WAAAoH,QAAA,CAAQ,iBAAe,CAAQ,CAAC,IAAC,CAACjE,wBAAwB,CAACiC,iBAAiB,CAACL,cAAc,CAAC,CAAC,CAAC,MAAI,EAAG,CAAC,cACzG7E,KAAA,MAAAkH,QAAA,eAAGpH,IAAA,WAAAoH,QAAA,CAAQ,mBAAiB,CAAQ,CAAC,IAAC,CAACjE,wBAAwB,CAACoC,iBAAiB,CAACR,cAAc,CAAC,CAAC,CAAC,MAAI,EAAG,CAAC,cAC3G7E,KAAA,MAAAkH,QAAA,eAAGpH,IAAA,WAAAoH,QAAA,CAAQ,2BAAmB,CAAQ,CAAC,IAAC,CAACjE,wBAAwB,CAACkC,kBAAkB,CAACN,cAAc,CAAC,CAAC,CAAC,MAAI,EAAG,CAAC,cAC9G7E,KAAA,MAAAkH,QAAA,eAAGpH,IAAA,WAAAoH,QAAA,CAAQ,oBAAkB,CAAQ,CAAC,IAAC,CAACjE,wBAAwB,CAACmC,uBAAuB,CAACP,cAAc,CAAC,CAAC,CAAC,MAAI,EAAG,CAAC,EAC/G,CAAC,cAEN7E,KAAA,CAAC8K,WAAW,EACVC,KAAK,CAAC,uBAAuB,CAC7BpB,KAAK,CAAE5F,YAAY,CAACJ,YAAa,CACjCqH,QAAQ,CAAGC,CAAiC,EAAKjH,eAAe,CAAC,CAC/D,GAAGD,YAAY,CACfJ,YAAY,CAAEsH,CAAC,CAACC,MAAM,CAACvB,KACzB,CAAC,CAAE,CACHwB,QAAQ,CAAE1I,YAAa,CAAAyE,QAAA,eAEvBpH,IAAA,WAAQ6J,KAAK,CAAC,SAAS,CAAAzC,QAAA,CAAC,uBAAqB,CAAQ,CAAC,cACtDpH,IAAA,WAAQ6J,KAAK,CAAC,eAAe,CAAAzC,QAAA,CAAC,2BAAmB,CAAQ,CAAC,cAC1DpH,IAAA,WAAQ6J,KAAK,CAAC,MAAM,CAAAzC,QAAA,CAAC,uBAAqB,CAAQ,CAAC,EACxC,CAAC,cAEdpH,IAAA,CAACwL,UAAU,EACTP,KAAK,CAAC,+BAA4B,CAClCtJ,IAAI,CAAC,QAAQ,CACb8J,IAAI,CAAC,KAAK,CACV5B,KAAK,CAAE5F,YAAY,CAAC7C,MAAO,CAC3B8J,QAAQ,CAAGC,CAAgC,EAAKjH,eAAe,CAAC,CAC9D,GAAGD,YAAY,CACf7C,MAAM,CAAEsK,UAAU,CAACP,CAAC,CAACC,MAAM,CAACvB,KAAK,CAAC,EAAI,CACxC,CAAC,CAAE,CACHwB,QAAQ,CAAE1I,YAAa,CACxB,CAAC,CAEDqC,qBAAqB,eACpB9E,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAACgF,cAAe,CAAA9E,QAAA,eAChClH,KAAA,OAAAkH,QAAA,eAAIpH,IAAA,CAACR,eAAe,EAACyK,IAAI,CAAEnK,YAAa,CAAE,CAAC,qCAA+B,EAAI,CAAC,cAC/EI,KAAA,MAAAkH,QAAA,eAAGpH,IAAA,WAAAoH,QAAA,CAAQ,WAAS,CAAQ,CAAC,IAAC,CAACpC,qBAAqB,CAACE,aAAa,CAACH,cAAc,CAAC,CAAC,CAAC,MAAI,EAAG,CAAC,cAC5F7E,KAAA,MAAAkH,QAAA,eAAGpH,IAAA,WAAAoH,QAAA,CAAQ,kBAAU,CAAQ,CAAC,IAAC,CAACpC,qBAAqB,CAACG,cAAc,CAACJ,cAAc,CAAC,CAAC,CAAC,MAAI,EAAG,CAAC,CAC7FC,qBAAqB,CAACzC,KAAK,eAC1BvC,IAAA,MAAGiH,KAAK,CAAE,CAAC2E,KAAK,CAAE,SAAS,CAAE,CAAAxE,QAAA,CAAEpC,qBAAqB,CAACzC,KAAK,CAAI,CAC/D,EACE,CACN,cAEDvC,IAAA,CAAC6L,aAAa,EACZZ,KAAK,CAAC,mBAAmB,CACzBpB,KAAK,CAAE5F,YAAY,CAACH,KAAM,CAC1BoH,QAAQ,CAAGC,CAAmC,EAAKjH,eAAe,CAAC,CACjE,GAAGD,YAAY,CACfH,KAAK,CAAEqH,CAAC,CAACC,MAAM,CAACvB,KAClB,CAAC,CAAE,CACHiC,WAAW,CAAC,+BAA+B,CAC3CT,QAAQ,CAAE1I,YAAa,CACxB,CAAC,EACC,CAAC,cAENzC,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC6E,YAAa,CAAA3E,QAAA,eAC9BpH,IAAA,WACEoJ,OAAO,CAAEA,CAAA,GAAMlG,uBAAuB,CAAC,KAAK,CAAE,CAC9C+D,KAAK,CAAE,CAAC,GAAGC,MAAM,CAACmC,MAAM,CAAEI,eAAe,CAAE,SAAS,CAAE,CACtD4B,QAAQ,CAAE1I,YAAa,CAAAyE,QAAA,CACxB,SAED,CAAQ,CAAC,cACTpH,IAAA,WACEoJ,OAAO,CAAEhB,mBAAoB,CAC7BnB,KAAK,CAAEC,MAAM,CAACmC,MAAO,CACrBgC,QAAQ,CAAE1I,YAAY,GAAKqC,qBAAqB,SAArBA,qBAAqB,WAArBA,qBAAqB,CAAEzC,KAAK,CAAG,IAAI,CAAG,KAAK,CAAE,CAAA6E,QAAA,CAEvEzE,YAAY,CAAG,eAAe,CAAG,4BAA4B,CACxD,CAAC,EACN,CAAC,EACH,CAAC,CACH,CACN,EACE,CAAC,CAEV,CAAC,CAED;AAEA;AACA,KAAM,CAAA+H,gBAIJ,CAAGyB,IAAA,MAAC,CAAEpJ,UAAU,CAAEV,OAAO,CAAE2E,QAAS,CAAC,CAAAmF,IAAA,oBACrCjM,KAAA,QAAAkH,QAAA,eACEpH,IAAA,OAAIiH,KAAK,CAAE,CAACmF,YAAY,CAAE,MAAM,CAAER,KAAK,CAAE,SAAS,CAAE,CAAAxE,QAAA,CAAC,+BAA6B,CAAI,CAAC,CAEtF/E,OAAO,cACNrC,IAAA,QAAKiH,KAAK,CAAEC,MAAM,CAACkD,gBAAiB,CAAAhD,QAAA,cAClCpH,IAAA,MAAAoH,QAAA,CAAG,kCAAgC,CAAG,CAAC,CACpC,CAAC,CACJrE,UAAU,CAAC6C,MAAM,GAAK,CAAC,cACzB5F,IAAA,QAAKiH,KAAK,CAAEC,MAAM,CAACmD,UAAW,CAAAjD,QAAA,cAC5BpH,IAAA,MAAAoH,QAAA,CAAG,oCAA+B,CAAG,CAAC,CACnC,CAAC,CACJJ,QAAQ,cACVhH,IAAA,QAAKiH,KAAK,CAAE,CAACoF,OAAO,CAAE,MAAM,CAAEC,aAAa,CAAE,QAAQ,CAAEC,GAAG,CAAE,MAAM,CAAE,CAAAnF,QAAA,CACjErE,UAAU,CAAC+F,GAAG,CAAC0D,SAAS,eACvBtM,KAAA,QAAwB+G,KAAK,CAAEC,MAAM,CAACuF,UAAW,CAAArF,QAAA,eAC/ClH,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAACwF,gBAAiB,CAAAtF,QAAA,eAClClH,KAAA,SAAM+G,KAAK,CAAE,CAAC0F,UAAU,CAAE,MAAM,CAAE,CAAAvF,QAAA,EAAC,WAC3B,CAACoF,SAAS,CAAC5I,YAAY,CAAC,KAAG,CAAC4I,SAAS,CAACI,gBAAgB,EACxD,CAAC,cACP5M,IAAA,SAAMiH,KAAK,CAAE,CAAC,GAAGC,MAAM,CAAC2F,IAAI,CAAEpD,eAAe,CAAE,SAAS,CAAEmC,KAAK,CAAE,SAAS,CAAE,CAAAxE,QAAA,CACzEpG,WAAW,CAACU,yBAAyB,CAAC8K,SAAS,CAAC3I,YAAY,CAAC,CAC1D,CAAC,EACJ,CAAC,cACN3D,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC4F,cAAe,CAAA1F,QAAA,eAChClH,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC6F,aAAc,CAAA3F,QAAA,eAC/BpH,IAAA,SAAAoH,QAAA,CAAM,UAAQ,CAAM,CAAC,cACrBlH,KAAA,WAAAkH,QAAA,EAASoF,SAAS,CAACpL,MAAM,CAAC2D,cAAc,CAAC,CAAC,CAAC,MAAI,EAAQ,CAAC,EACrD,CAAC,cACN7E,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC6F,aAAc,CAAA3F,QAAA,eAC/BpH,IAAA,SAAAoH,QAAA,CAAM,UAAQ,CAAM,CAAC,cACrBlH,KAAA,SAAAkH,QAAA,EAAOoF,SAAS,CAAClE,cAAc,CAACvD,cAAc,CAAC,CAAC,CAAC,MAAI,EAAM,CAAC,EACzD,CAAC,cACN7E,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC6F,aAAc,CAAA3F,QAAA,eAC/BpH,IAAA,SAAAoH,QAAA,CAAM,iBAAS,CAAM,CAAC,cACtBlH,KAAA,SAAAkH,QAAA,EAAOoF,SAAS,CAACjE,eAAe,CAACxD,cAAc,CAAC,CAAC,CAAC,MAAI,EAAM,CAAC,EAC1D,CAAC,cACN7E,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC6F,aAAc,CAAA3F,QAAA,eAC/BpH,IAAA,SAAAoH,QAAA,CAAM,OAAK,CAAM,CAAC,cAClBpH,IAAA,SAAAoH,QAAA,CAAO,GAAI,CAAA4F,IAAI,CAACR,SAAS,CAACS,IAAI,CAAC,CAACC,kBAAkB,CAAC,OAAO,CAAC,CAAO,CAAC,EAChE,CAAC,CACLV,SAAS,CAACW,iBAAiB,eAC1BjN,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC6F,aAAc,CAAA3F,QAAA,eAC/BpH,IAAA,SAAAoH,QAAA,CAAM,gBAAW,CAAM,CAAC,cACxBpH,IAAA,SAAAoH,QAAA,CAAOoF,SAAS,CAACW,iBAAiB,CAAO,CAAC,EACvC,CACN,EACE,CAAC,GAhCEX,SAAS,CAAC9H,EAiCf,CACN,CAAC,CACC,CAAC,cAEN1E,IAAA,QAAKiH,KAAK,CAAEC,MAAM,CAACkG,cAAe,CAAAhG,QAAA,cAChClH,KAAA,UAAO+G,KAAK,CAAEC,MAAM,CAACmG,KAAM,CAAAjG,QAAA,eACzBpH,IAAA,UAAAoH,QAAA,cACElH,KAAA,OAAAkH,QAAA,eACEpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,SAAI,CAAI,CAAC,cAC/BpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,YAAU,CAAI,CAAC,cACrCpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,SAAO,CAAI,CAAC,cAClCpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,SAAO,CAAI,CAAC,cAClCpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,gBAAQ,CAAI,CAAC,cACnCpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,MAAI,CAAI,CAAC,cAC/BpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,MAAI,CAAI,CAAC,cAC/BpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,eAAU,CAAI,CAAC,EACnC,CAAC,CACA,CAAC,cACRpH,IAAA,UAAAoH,QAAA,CACGrE,UAAU,CAAC+F,GAAG,CAAC0D,SAAS,eACvBtM,KAAA,OAAAkH,QAAA,eACElH,KAAA,OAAI+G,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,EAAC,GAAC,CAACoF,SAAS,CAAC5I,YAAY,EAAK,CAAC,cACpD5D,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,CAAEoF,SAAS,CAACI,gBAAgB,CAAK,CAAC,cACvD1M,KAAA,OAAI+G,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,EAAEoF,SAAS,CAACpL,MAAM,CAAC2D,cAAc,CAAC,CAAC,CAAC,MAAI,EAAI,CAAC,cAClE7E,KAAA,OAAI+G,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,EAAEoF,SAAS,CAAClE,cAAc,CAACvD,cAAc,CAAC,CAAC,CAAC,MAAI,EAAI,CAAC,cAC1E7E,KAAA,OAAI+G,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,EAAEoF,SAAS,CAACjE,eAAe,CAACxD,cAAc,CAAC,CAAC,CAAC,MAAI,EAAI,CAAC,cAC3E/E,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,cACnBpH,IAAA,SAAMiH,KAAK,CAAE,CAAC,GAAGC,MAAM,CAAC2F,IAAI,CAAEpD,eAAe,CAAE,SAAS,CAAEmC,KAAK,CAAE,SAAS,CAAE,CAAAxE,QAAA,CACzEpG,WAAW,CAACU,yBAAyB,CAAC8K,SAAS,CAAC3I,YAAY,CAAC,CAC1D,CAAC,CACL,CAAC,cACL7D,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,CAAE,GAAI,CAAA4F,IAAI,CAACR,SAAS,CAACS,IAAI,CAAC,CAACC,kBAAkB,CAAC,OAAO,CAAC,CAAK,CAAC,cACjFlN,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,CAAEoF,SAAS,CAACW,iBAAiB,EAAI,GAAG,CAAK,CAAC,GAZxDX,SAAS,CAAC9H,EAaf,CACL,CAAC,CACG,CAAC,EACH,CAAC,CACL,CACN,EACE,CAAC,EACP,CAED;AAYA,KAAM,CAAA+F,gBAAsC,CAAG+C,KAAA,MAAC,CAC9CvL,KAAK,CACLE,OAAO,CACPJ,aAAa,CACbwI,cAAc,CACdC,WAAW,CACXhC,aAAa,CACbI,iBAAiB,CACjBO,gBACF,CAAC,CAAAqE,KAAA,oBACCxN,IAAA,QAAKiH,KAAK,CAAEC,MAAM,CAACkG,cAAe,CAAAhG,QAAA,cAChClH,KAAA,UAAO+G,KAAK,CAAEC,MAAM,CAACmG,KAAM,CAAAjG,QAAA,eACzBpH,IAAA,UAAAoH,QAAA,cACElH,KAAA,OAAAkH,QAAA,eACEpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,QAAM,CAAI,CAAC,cACjCpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,SAAO,CAAI,CAAC,cAClCpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,OAAK,CAAI,CAAC,cAChCpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,aAAW,CAAI,CAAC,cACtCpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,QAAM,CAAI,CAAC,cACjCpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACoG,EAAG,CAAAlG,QAAA,CAAC,SAAO,CAAI,CAAC,EAChC,CAAC,CACA,CAAC,cACRpH,IAAA,UAAAoH,QAAA,CACGnF,KAAK,CAAC6G,GAAG,CAAC7D,IAAI,EAAI,CACjB,KAAM,CAAAwI,kBAAkB,CAAG,CAAExI,IAAI,CAACgB,YAAY,CAAGhB,IAAI,CAACyI,0BAA0B,CAAI,GAAG,EAAEC,OAAO,CAAC,CAAC,CAAC,CAEnG,mBACEzN,KAAA,OAAAkH,QAAA,eACEpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,CAAEnC,IAAI,CAACgH,WAAW,CAAK,CAAC,cAC7C/L,KAAA,OAAI+G,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,EAAEnC,IAAI,CAAC7D,MAAM,CAAC2D,cAAc,CAAC,CAAC,CAAC,MAAI,EAAI,CAAC,cAC7D/E,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,CAClBnC,IAAI,CAACzD,MAAM,GAAK,UAAU,cACzBtB,KAAA,QAAAkH,QAAA,eACElH,KAAA,QAAAkH,QAAA,EAAMnC,IAAI,CAACG,iBAAiB,CAACL,cAAc,CAAC,CAAC,CAAC,MAAI,EAAK,CAAC,cACxD7E,KAAA,QAAK+G,KAAK,CAAE,CAAC2G,QAAQ,CAAE,MAAM,CAAEhC,KAAK,CAAE,SAAS,CAAE,CAAAxE,QAAA,EAAC,MAC5C,CAACnC,IAAI,CAACyI,0BAA0B,CAAC3I,cAAc,CAAC,CAAC,CAAC,MACxD,EAAK,CAAC,EACH,CAAC,CAENE,IAAI,CAACyI,0BAA0B,CAAC3I,cAAc,CAAC,CAAC,CAAG,MACpD,CACC,CAAC,cACL/E,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,CAClBnC,IAAI,CAACzD,MAAM,GAAK,UAAU,eACzBtB,KAAA,QAAK+G,KAAK,CAAE,CAACpG,KAAK,CAAE,OAAO,CAAE,CAAAuG,QAAA,eAC3BpH,IAAA,QAAKiH,KAAK,CAAE,CACVwC,eAAe,CAAE,SAAS,CAC1BoE,YAAY,CAAE,KAAK,CACnBC,MAAM,CAAE,KAAK,CACbC,QAAQ,CAAE,QACZ,CAAE,CAAA3G,QAAA,cACApH,IAAA,QAAKiH,KAAK,CAAE,CACVwC,eAAe,CAAExE,IAAI,CAAC+I,eAAe,CAAG,SAAS,CAAG,SAAS,CAC7DF,MAAM,CAAE,MAAM,CACdjN,KAAK,CAAE,GAAG4M,kBAAkB,GAAG,CAC/BQ,UAAU,CAAE,iBACd,CAAE,CAAE,CAAC,CACF,CAAC,cACN/N,KAAA,QAAK+G,KAAK,CAAE,CAAC2G,QAAQ,CAAE,MAAM,CAAEM,SAAS,CAAE,KAAK,CAAEC,SAAS,CAAE,QAAQ,CAAE,CAAA/G,QAAA,EACnEqG,kBAAkB,CAAC,GACtB,EAAK,CAAC,EACH,CACN,CACC,CAAC,cACLzN,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,cACnBpH,IAAA,CAACoO,UAAU,EAAC5M,MAAM,CAAER,WAAW,CAACO,oBAAoB,CAAC0D,IAAI,CAACzD,MAAM,CAAE,CAAE,CAAC,CACnE,CAAC,cACLxB,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAACqG,EAAG,CAAAnG,QAAA,cACnBlH,KAAA,QAAK+G,KAAK,CAAE,CAAEoF,OAAO,CAAE,MAAM,CAAEE,GAAG,CAAE,KAAK,CAAE8B,QAAQ,CAAE,MAAO,CAAE,CAAAjH,QAAA,EAC3DnC,IAAI,CAACzD,MAAM,GAAK,SAAS,EAAIO,aAAa,CAAC,eAAe,CAAC,eAC1D7B,KAAA,CAAAE,SAAA,EAAAgH,QAAA,eACEpH,IAAA,WACEoJ,OAAO,CAAEA,CAAA,GAAMmB,cAAc,CAACtF,IAAI,CAACP,EAAE,CAAE,UAAU,CAAE,CACnDuC,KAAK,CAAE,CAAC,GAAGC,MAAM,CAACoH,YAAY,CAAE7E,eAAe,CAAE,SAAS,CAAE,CAC5DG,KAAK,CAAC,WAAW,CAAAxC,QAAA,cAEjBpH,IAAA,CAACR,eAAe,EAACyK,IAAI,CAAEvK,OAAQ,CAAE,CAAC,CAC5B,CAAC,cACTM,IAAA,WACEoJ,OAAO,CAAEA,CAAA,GAAMmB,cAAc,CAACtF,IAAI,CAACP,EAAE,CAAE,UAAU,CAAE,CACnDuC,KAAK,CAAE,CAAC,GAAGC,MAAM,CAACoH,YAAY,CAAE7E,eAAe,CAAE,SAAS,CAAE,CAC5DG,KAAK,CAAC,SAAS,CAAAxC,QAAA,cAEfpH,IAAA,CAACR,eAAe,EAACyK,IAAI,CAAEtK,OAAQ,CAAE,CAAC,CAC5B,CAAC,EACT,CACH,CACAsF,IAAI,CAACzD,MAAM,GAAK,UAAU,EAAI,CAACyD,IAAI,CAAC+I,eAAe,EAAI7E,gBAAgB,eACtEnJ,IAAA,WACEoJ,OAAO,CAAEA,CAAA,GAAMoB,WAAW,CAACvF,IAAI,CAAE,CACjCgC,KAAK,CAAE,CAAC,GAAGC,MAAM,CAACoH,YAAY,CAAE7E,eAAe,CAAE,SAAS,CAAE,CAC5DG,KAAK,CAAC,YAAY,CAAAxC,QAAA,cAElBpH,IAAA,CAACR,eAAe,EAACyK,IAAI,CAAErK,eAAgB,CAAE,CAAC,CACpC,CACT,EACE,CAAC,CACJ,CAAC,GAtEEqF,IAAI,CAACP,EAuEV,CAAC,CAET,CAAC,CAAC,CACG,CAAC,EACH,CAAC,CACL,CAAC,EACP,CAED,KAAM,CAAA4F,cAAoC,CAAGiE,KAAA,MAAC,CAC5CtM,KAAK,CACLE,OAAO,CACPJ,aAAa,CACbwI,cAAc,CACdC,WAAW,CACXhC,aAAa,CACbI,iBAAiB,CACjBO,gBACF,CAAC,CAAAoF,KAAA,oBACCvO,IAAA,QAAKiH,KAAK,CAAE,CAACoF,OAAO,CAAE,MAAM,CAAEC,aAAa,CAAE,QAAQ,CAAEC,GAAG,CAAE,MAAM,CAAE,CAAAnF,QAAA,CACjEnF,KAAK,CAAC6G,GAAG,CAAC7D,IAAI,EAAI,CACjB,KAAM,CAAAwI,kBAAkB,CAAG,CAAExI,IAAI,CAACgB,YAAY,CAAGhB,IAAI,CAACyI,0BAA0B,CAAI,GAAG,EAAEC,OAAO,CAAC,CAAC,CAAC,CAEnG,mBACEzN,KAAA,QAAmB+G,KAAK,CAAEC,MAAM,CAACuF,UAAW,CAAArF,QAAA,eAC1ClH,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAACwF,gBAAiB,CAAAtF,QAAA,eAClCpH,IAAA,SAAMiH,KAAK,CAAE,CAAC0F,UAAU,CAAE,MAAM,CAAEf,KAAK,CAAE,SAAS,CAAE,CAAAxE,QAAA,CACjDnC,IAAI,CAACgH,WAAW,CACb,CAAC,cACPjM,IAAA,CAACoO,UAAU,EAAC5M,MAAM,CAAER,WAAW,CAACO,oBAAoB,CAAC0D,IAAI,CAACzD,MAAM,CAAE,CAAE,CAAC,EAClE,CAAC,cACNtB,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC4F,cAAe,CAAA1F,QAAA,eAChClH,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC6F,aAAc,CAAA3F,QAAA,eAC/BpH,IAAA,SAAAoH,QAAA,CAAM,kBAAgB,CAAM,CAAC,cAC7BlH,KAAA,WAAAkH,QAAA,EAASnC,IAAI,CAAC7D,MAAM,CAAC2D,cAAc,CAAC,CAAC,CAAC,MAAI,EAAQ,CAAC,EAChD,CAAC,CACLE,IAAI,CAACzD,MAAM,GAAK,UAAU,eACzBtB,KAAA,CAAAE,SAAA,EAAAgH,QAAA,eACElH,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC6F,aAAc,CAAA3F,QAAA,eAC/BpH,IAAA,SAAAoH,QAAA,CAAM,gBAAc,CAAM,CAAC,cAC3BlH,KAAA,WAAQ+G,KAAK,CAAE,CAAC2E,KAAK,CAAE3G,IAAI,CAAC+I,eAAe,CAAG,SAAS,CAAG,SAAS,CAAE,CAAA5G,QAAA,EAClEnC,IAAI,CAACG,iBAAiB,CAACL,cAAc,CAAC,CAAC,CAAC,MAC3C,EAAQ,CAAC,EACN,CAAC,cACN7E,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAAC6F,aAAc,CAAA3F,QAAA,eAC/BpH,IAAA,SAAAoH,QAAA,CAAM,cAAY,CAAM,CAAC,cACzBlH,KAAA,SAAAkH,QAAA,EAAOqG,kBAAkB,CAAC,gBAAW,EAAM,CAAC,EACzC,CAAC,EACN,CACH,EACE,CAAC,cAENvN,KAAA,QAAK+G,KAAK,CAAEC,MAAM,CAACsH,gBAAiB,CAAApH,QAAA,EACjCnC,IAAI,CAACzD,MAAM,GAAK,SAAS,EAAIO,aAAa,CAAC,eAAe,CAAC,eAC1D7B,KAAA,CAAAE,SAAA,EAAAgH,QAAA,eACElH,KAAA,WACEkJ,OAAO,CAAEA,CAAA,GAAMmB,cAAc,CAACtF,IAAI,CAACP,EAAE,CAAE,UAAU,CAAE,CACnDuC,KAAK,CAAE,CAAC,GAAGC,MAAM,CAACmC,MAAM,CAAEoF,IAAI,CAAE,CAAC,CAAEhF,eAAe,CAAE,SAAS,CAAE,CAAArC,QAAA,eAE/DpH,IAAA,CAACR,eAAe,EAACyK,IAAI,CAAEvK,OAAQ,CAACuH,KAAK,CAAE,CAACiD,WAAW,CAAE,KAAK,CAAE,CAAC,CAAC,YAEhE,EAAQ,CAAC,cACThK,KAAA,WACEkJ,OAAO,CAAEA,CAAA,GAAMmB,cAAc,CAACtF,IAAI,CAACP,EAAE,CAAE,UAAU,CAAE,CACnDuC,KAAK,CAAE,CAAC,GAAGC,MAAM,CAACmC,MAAM,CAAEoF,IAAI,CAAE,CAAC,CAAEhF,eAAe,CAAE,SAAS,CAAE,CAAArC,QAAA,eAE/DpH,IAAA,CAACR,eAAe,EAACyK,IAAI,CAAEtK,OAAQ,CAACsH,KAAK,CAAE,CAACiD,WAAW,CAAE,KAAK,CAAE,CAAC,CAAC,UAEhE,EAAQ,CAAC,EACT,CACH,CACAjF,IAAI,CAACzD,MAAM,GAAK,UAAU,EAAI,CAACyD,IAAI,CAAC+I,eAAe,EAAI7E,gBAAgB,eACtEjJ,KAAA,WACEkJ,OAAO,CAAEA,CAAA,GAAMoB,WAAW,CAACvF,IAAI,CAAE,CACjCgC,KAAK,CAAE,CAAC,GAAGC,MAAM,CAACmC,MAAM,CAAEoF,IAAI,CAAE,CAAC,CAAEhF,eAAe,CAAE,SAAS,CAAE,CAAArC,QAAA,eAE/DpH,IAAA,CAACR,eAAe,EAACyK,IAAI,CAAErK,eAAgB,CAACqH,KAAK,CAAE,CAACiD,WAAW,CAAE,KAAK,CAAE,CAAC,CAAC,aAExE,EAAQ,CACT,EACE,CAAC,GAxDEjF,IAAI,CAACP,EAyDV,CAAC,CAEV,CAAC,CAAC,CACC,CAAC,EACP,CAED;AACA,KAAM,CAAAiF,QAA6D,CAAG+E,KAAA,MAAC,CAAE9E,KAAK,CAAEC,KAAM,CAAC,CAAA6E,KAAA,oBACrFxO,KAAA,QAAK+G,KAAK,CAAE,CAAC,GAAGC,MAAM,CAACyH,IAAI,CAAEF,IAAI,CAAE,WAAW,CAAEN,SAAS,CAAE,QAAS,CAAE,CAAA/G,QAAA,eACpEpH,IAAA,OAAIiH,KAAK,CAAEC,MAAM,CAAC0H,SAAU,CAAAxH,QAAA,CAAEwC,KAAK,CAAK,CAAC,cACzC5J,IAAA,MAAGiH,KAAK,CAAEC,MAAM,CAAC2H,SAAU,CAAAzH,QAAA,CAAEyC,KAAK,CAAI,CAAC,EACpC,CAAC,EACP,CAED,KAAM,CAAAuE,UAAwC,CAAGU,KAAA,EAAgB,IAAf,CAAEtN,MAAO,CAAC,CAAAsN,KAAA,CAC1D,KAAM,CAAAC,YAA2E,CAAG,CAClF,YAAY,CAAE,CAAEtF,eAAe,CAAE,SAAS,CAAEmC,KAAK,CAAE,SAAU,CAAC,CAC9D,UAAU,CAAE,CAAEnC,eAAe,CAAE,SAAS,CAAEmC,KAAK,CAAE,SAAU,CAAC,CAC5D,QAAQ,CAAE,CAAEnC,eAAe,CAAE,SAAS,CAAEmC,KAAK,CAAE,SAAU,CAAC,CAC1D,WAAW,CAAE,CAAEnC,eAAe,CAAE,SAAS,CAAEmC,KAAK,CAAE,SAAU,CAC9D,CAAC,CAED,mBACE5L,IAAA,SAAMiH,KAAK,CAAE,CAAE,GAAGC,MAAM,CAAC2F,IAAI,CAAE,GAAGkC,YAAY,CAACvN,MAAM,CAAE,CAAE,CAAA4F,QAAA,CACtD5F,MAAM,CACH,CAAC,CAEX,CAAC,CAKD,KAAM,CAAAgK,UAAqC,CAAGwD,KAAA,MAAC,CAAE/D,KAAK,CAAE,GAAGgE,KAAM,CAAC,CAAAD,KAAA,oBAChE9O,KAAA,QAAAkH,QAAA,eACEpH,IAAA,UAAOiH,KAAK,CAAEC,MAAM,CAACoE,UAAW,CAAAlE,QAAA,CAAE6D,KAAK,CAAQ,CAAC,cAChDjL,IAAA,UAAOiH,KAAK,CAAEC,MAAM,CAACgI,UAAW,IAAKD,KAAK,CAAG,CAAC,EAC3C,CAAC,EACP,CAMD,KAAM,CAAAjE,WAAuC,CAAGmE,KAAA,MAAC,CAAElE,KAAK,CAAE7D,QAAQ,CAAE,GAAG6H,KAAM,CAAC,CAAAE,KAAA,oBAC5EjP,KAAA,QAAAkH,QAAA,eACEpH,IAAA,UAAOiH,KAAK,CAAEC,MAAM,CAACoE,UAAW,CAAAlE,QAAA,CAAE6D,KAAK,CAAQ,CAAC,cAChDjL,IAAA,WAAQiH,KAAK,CAAEC,MAAM,CAACgI,UAAW,IAAKD,KAAK,CAAA7H,QAAA,CAAGA,QAAQ,CAAS,CAAC,EAC7D,CAAC,EACP,CAKD,KAAM,CAAAyE,aAA2C,CAAGuD,KAAA,MAAC,CAAEnE,KAAK,CAAE,GAAGgE,KAAM,CAAC,CAAAG,KAAA,oBACtElP,KAAA,QAAAkH,QAAA,eACEpH,IAAA,UAAOiH,KAAK,CAAEC,MAAM,CAACoE,UAAW,CAAAlE,QAAA,CAAE6D,KAAK,CAAQ,CAAC,cAChDjL,IAAA,aAAUiH,KAAK,CAAE,CAAC,GAAGC,MAAM,CAACgI,UAAU,CAAEpB,MAAM,CAAE,MAAM,CAAE,IAAKmB,KAAK,CAAG,CAAC,EACnE,CAAC,EACP,CAED,KAAM,CAAA/H,MAA8C,CAAG,CACrDC,IAAI,CAAE,CAAEkI,UAAU,CAAE,mBAAmB,CAAEC,OAAO,CAAE,MAAM,CAAE7F,eAAe,CAAE,SAAS,CAAE8F,SAAS,CAAE,OAAQ,CAAC,CAC1GjG,MAAM,CAAE,CAAE+C,OAAO,CAAE,MAAM,CAAEmD,cAAc,CAAE,eAAe,CAAEC,UAAU,CAAE,QAAQ,CAAErD,YAAY,CAAE,MAAM,CAAEiC,QAAQ,CAAE,MAAM,CAAE9B,GAAG,CAAE,MAAO,CAAC,CACvIhD,WAAW,CAAE,CAAEqE,QAAQ,CAAE,MAAM,CAAEjB,UAAU,CAAE,MAAM,CAAEf,KAAK,CAAE,SAAS,CAAE8D,MAAM,CAAE,CAAE,CAAC,CAClFlG,WAAW,CAAE,CAAEoE,QAAQ,CAAE,MAAM,CAAEjB,UAAU,CAAE,QAAQ,CAAEf,KAAK,CAAE,SAAU,CAAC,CACzEvE,cAAc,CAAE,CAAE8G,SAAS,CAAE,QAAQ,CAAEmB,OAAO,CAAE,MAAM,CAAE7F,eAAe,CAAE,OAAO,CAAEoE,YAAY,CAAE,MAAM,CAAE8B,SAAS,CAAE,gCAAiC,CAAC,CACrJvF,gBAAgB,CAAE,CAAE+D,SAAS,CAAE,QAAQ,CAAEmB,OAAO,CAAE,MAAO,CAAC,CAC1DjF,UAAU,CAAE,CAAE8D,SAAS,CAAE,QAAQ,CAAEmB,OAAO,CAAE,MAAM,CAAE7F,eAAe,CAAE,OAAO,CAAEoE,YAAY,CAAE,MAAM,CAAE8B,SAAS,CAAE,gCAAiC,CAAC,CACjJjG,WAAW,CAAE,CAAE2C,OAAO,CAAE,MAAM,CAAEE,GAAG,CAAE,MAAM,CAAE8B,QAAQ,CAAE,MAAM,CAAEjC,YAAY,CAAE,MAAO,CAAC,CACrFuC,IAAI,CAAE,CAAElF,eAAe,CAAE,OAAO,CAAE6F,OAAO,CAAE,MAAM,CAAEzB,YAAY,CAAE,MAAM,CAAE8B,SAAS,CAAE,gCAAiC,CAAC,CACtHf,SAAS,CAAE,CAAEc,MAAM,CAAE,CAAC,CAAE9D,KAAK,CAAE,SAAS,CAAEgC,QAAQ,CAAE,MAAM,CAAEjB,UAAU,CAAE,KAAM,CAAC,CAC/EkC,SAAS,CAAE,CAAEa,MAAM,CAAE,WAAW,CAAE9D,KAAK,CAAE,SAAS,CAAEgC,QAAQ,CAAE,MAAM,CAAEjB,UAAU,CAAE,MAAO,CAAC,CAE1F;AACA7C,UAAU,CAAE,CAAEuC,OAAO,CAAE,MAAM,CAAED,YAAY,CAAE,MAAM,CAAE3C,eAAe,CAAE,OAAO,CAAEoE,YAAY,CAAE,MAAM,CAAEE,QAAQ,CAAE,QAAQ,CAAE4B,SAAS,CAAE,gCAAiC,CAAC,CACtK5F,SAAS,CAAE,CAAE0E,IAAI,CAAE,CAAC,CAAEa,OAAO,CAAE,WAAW,CAAEM,MAAM,CAAE,MAAM,CAAEhC,QAAQ,CAAE,MAAM,CAAEjB,UAAU,CAAE,KAAK,CAAEkD,MAAM,CAAE,SAAS,CAAE5B,UAAU,CAAE,UAAU,CAAE5B,OAAO,CAAE,MAAM,CAAEoD,UAAU,CAAE,QAAQ,CAAED,cAAc,CAAE,QAAS,CAAC,CAC7MnM,SAAS,CAAE,CAAEoG,eAAe,CAAE,SAAS,CAAEmC,KAAK,CAAE,OAAQ,CAAC,CACzD5B,WAAW,CAAE,CAAEP,eAAe,CAAE,OAAO,CAAEmC,KAAK,CAAE,SAAU,CAAC,CAE3DzB,eAAe,CAAE,CAAEiC,YAAY,CAAE,MAAO,CAAC,CACzC/C,MAAM,CAAE,CAAEiG,OAAO,CAAE,WAAW,CAAE7F,eAAe,CAAE,SAAS,CAAEmC,KAAK,CAAE,OAAO,CAAEgE,MAAM,CAAE,MAAM,CAAE/B,YAAY,CAAE,KAAK,CAAEgC,MAAM,CAAE,SAAS,CAAElD,UAAU,CAAE,KAAK,CAAEN,OAAO,CAAE,MAAM,CAAEoD,UAAU,CAAE,QAAQ,CAAED,cAAc,CAAE,QAAQ,CAAEvB,UAAU,CAAE,uBAAuB,CAAEL,QAAQ,CAAE,MAAO,CAAC,CAC/QjD,cAAc,CAAE,CAAElB,eAAe,CAAE,SAAS,CAAE6F,OAAO,CAAE,MAAM,CAAEzB,YAAY,CAAE,KAAK,CAAEK,SAAS,CAAE,MAAM,CAAE0B,MAAM,CAAE,mBAAoB,CAAC,CACpIxC,cAAc,CAAE,CAAE3D,eAAe,CAAE,OAAO,CAAEoE,YAAY,CAAE,MAAM,CAAE8B,SAAS,CAAE,gCAAgC,CAAEG,SAAS,CAAE,MAAO,CAAC,CAClIzC,KAAK,CAAE,CAAExM,KAAK,CAAE,MAAM,CAAEkP,cAAc,CAAE,UAAW,CAAC,CACpDzC,EAAE,CAAE,CAAEgC,OAAO,CAAE,WAAW,CAAEnB,SAAS,CAAE,MAAM,CAAEP,QAAQ,CAAE,MAAM,CAAEhC,KAAK,CAAE,SAAS,CAAEnC,eAAe,CAAE,SAAS,CAAEuG,YAAY,CAAE,mBAAmB,CAAErD,UAAU,CAAE,KAAM,CAAC,CACrKY,EAAE,CAAE,CAAE+B,OAAO,CAAE,WAAW,CAAE1B,QAAQ,CAAE,MAAM,CAAEhC,KAAK,CAAE,SAAS,CAAEoE,YAAY,CAAE,mBAAmB,CAAEC,aAAa,CAAE,QAAS,CAAC,CAC5HpD,IAAI,CAAE,CAAEyC,OAAO,CAAE,UAAU,CAAEzB,YAAY,CAAE,QAAQ,CAAElB,UAAU,CAAE,KAAK,CAAEiB,QAAQ,CAAE,MAAO,CAAC,CAC1FU,YAAY,CAAE,CAAEgB,OAAO,CAAE,UAAU,CAAEM,MAAM,CAAE,MAAM,CAAE/B,YAAY,CAAE,KAAK,CAAEjC,KAAK,CAAE,OAAO,CAAEiE,MAAM,CAAE,SAAS,CAAExD,OAAO,CAAE,MAAM,CAAEoD,UAAU,CAAE,QAAQ,CAAED,cAAc,CAAE,QAAQ,CAAE5B,QAAQ,CAAE,MAAM,CAAEjB,UAAU,CAAE,MAAO,CAAC,CAEpN;AACA/B,YAAY,CAAE,CAAEsF,QAAQ,CAAE,OAAO,CAAEC,GAAG,CAAE,CAAC,CAAEC,IAAI,CAAE,CAAC,CAAEC,KAAK,CAAE,CAAC,CAAEC,MAAM,CAAE,CAAC,CAAE7G,eAAe,CAAE,oBAAoB,CAAE4C,OAAO,CAAE,MAAM,CAAEmD,cAAc,CAAE,QAAQ,CAAEC,UAAU,CAAE,QAAQ,CAAEc,MAAM,CAAE,IAAI,CAAEjB,OAAO,CAAE,MAAO,CAAC,CAChNzE,YAAY,CAAE,CAAEpB,eAAe,CAAE,OAAO,CAAE6F,OAAO,CAAE,MAAM,CAAEzB,YAAY,CAAE,MAAM,CAAEhN,KAAK,CAAE,MAAM,CAAE2P,QAAQ,CAAE,OAAO,CAAEb,SAAS,CAAE,+BAA+B,CAAEc,SAAS,CAAE,MAAM,CAAEpE,OAAO,CAAE,MAAM,CAAEC,aAAa,CAAE,QAAS,CAAC,CAC5NxB,UAAU,CAAE,CAAE8C,QAAQ,CAAE,MAAM,CAAEjB,UAAU,CAAE,MAAM,CAAEP,YAAY,CAAE,MAAM,CAAER,KAAK,CAAE,SAAS,CAAE8E,UAAU,CAAE,CAAC,CAAEvC,SAAS,CAAE,QAAS,CAAC,CAChIpD,SAAS,CAAE,CAAE4F,QAAQ,CAAE,CAAC,CAAEC,SAAS,CAAE,MAAM,CAAEC,YAAY,CAAE,MAAM,CAAE3G,WAAW,CAAE,OAAO,CAAEmC,OAAO,CAAE,MAAM,CAAEC,aAAa,CAAE,QAAQ,CAAEC,GAAG,CAAE,MAAO,CAAC,CAChJjB,UAAU,CAAE,CAAEe,OAAO,CAAE,OAAO,CAAED,YAAY,CAAE,KAAK,CAAEO,UAAU,CAAE,KAAK,CAAEf,KAAK,CAAE,SAAS,CAAEgC,QAAQ,CAAE,MAAO,CAAC,CAC5GsB,UAAU,CAAE,CAAErO,KAAK,CAAE,MAAM,CAAEyO,OAAO,CAAE,MAAM,CAAEM,MAAM,CAAE,mBAAmB,CAAE/B,YAAY,CAAE,KAAK,CAAEiD,SAAS,CAAE,YAAY,CAAElD,QAAQ,CAAE,MAAO,CAAC,CAC3IrC,aAAa,CAAE,CAAE1K,KAAK,CAAE,MAAM,CAAEyO,OAAO,CAAE,MAAM,CAAEM,MAAM,CAAE,mBAAmB,CAAEnG,eAAe,CAAE,SAAS,CAAEmC,KAAK,CAAE,SAAS,CAAEiC,YAAY,CAAE,KAAK,CAAEiD,SAAS,CAAE,YAAY,CAAElD,QAAQ,CAAE,MAAO,CAAC,CAC5L7B,YAAY,CAAE,CAAEM,OAAO,CAAE,MAAM,CAAEmD,cAAc,CAAE,UAAU,CAAEjD,GAAG,CAAE,MAAM,CAAE2B,SAAS,CAAE,MAAM,CAAEwC,UAAU,CAAE,CAAE,CAAC,CAC5G7N,SAAS,CAAE,CAAE+I,KAAK,CAAE,SAAS,CAAEnC,eAAe,CAAE,SAAS,CAAE6F,OAAO,CAAE,MAAM,CAAEzB,YAAY,CAAE,KAAK,CAAEM,SAAS,CAAE,QAAQ,CAAE/B,YAAY,CAAE,MAAO,CAAC,CAE5I;AACAT,cAAc,CAAE,CAAElC,eAAe,CAAE,SAAS,CAAE6F,OAAO,CAAE,MAAM,CAAEzB,YAAY,CAAE,KAAK,CAAED,QAAQ,CAAE,MAAM,CAAEmD,UAAU,CAAE,GAAG,CAAEC,UAAU,CAAE,mBAAmB,CAAC,CACvJhF,WAAW,CAAE,CAAEvC,eAAe,CAAE,SAAS,CAAE6F,OAAO,CAAE,MAAM,CAAEzB,YAAY,CAAE,KAAK,CAAED,QAAQ,CAAE,MAAM,CAAEmD,UAAU,CAAE,GAAG,CAAEC,UAAU,CAAE,mBAAoB,CAAC,CACrJ9E,cAAc,CAAE,CAAEzC,eAAe,CAAE,SAAS,CAAE6F,OAAO,CAAE,MAAM,CAAEzB,YAAY,CAAE,KAAK,CAAED,QAAQ,CAAE,MAAM,CAAEmD,UAAU,CAAE,GAAG,CAAEC,UAAU,CAAE,mBAAoB,CAAC,CAExJ;AACAvE,UAAU,CAAE,CAAEhD,eAAe,CAAE,OAAO,CAAEoE,YAAY,CAAE,MAAM,CAAE8B,SAAS,CAAE,gCAAgC,CAAE5B,QAAQ,CAAE,QAAQ,CAAC,CAC9HrB,gBAAgB,CAAE,CAAEL,OAAO,CAAE,MAAM,CAAEmD,cAAc,CAAE,eAAe,CAAEC,UAAU,CAAE,QAAQ,CAAEH,OAAO,CAAE,WAAW,CAAE7F,eAAe,CAAE,SAAS,CAAEuG,YAAY,CAAE,mBAAmB,CAAC,CAChLlD,cAAc,CAAE,CAAEwC,OAAO,CAAE,MAAM,CAAEjD,OAAO,CAAE,MAAM,CAAEC,aAAa,CAAE,QAAQ,CAAEC,GAAG,CAAE,MAAO,CAAC,CAC1FQ,aAAa,CAAE,CAAEV,OAAO,CAAE,MAAM,CAAEmD,cAAc,CAAE,eAAe,CAAE5B,QAAQ,CAAE,MAAO,CAAC,CACrFY,gBAAgB,CAAE,CAAEc,OAAO,CAAE,WAAW,CAAE7F,eAAe,CAAE,SAAS,CAAEwH,SAAS,CAAE,mBAAmB,CAAE5E,OAAO,CAAE,MAAM,CAAEE,GAAG,CAAE,MAAO,CACrI,CAAC,CAED,cAAe,CAAA1K,KAAK","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}